!function Yu(Fu){var Lu=Fu.document;!function(t,m,o){var h="default"in t?t.default:t,E="default"in m?m.default:m;o=o&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o;var a=h.Promise,l=h.eventSandbox.message,u="automation|scroll|request",c="automation|scroll|response";l.on(l.SERVICE_MSG_RECEIVED_EVENT,function(t){if(t.message.cmd===u){var e=t.message,n=e.offsetX,i=e.offsetY,o=e.maxScrollMargin,r=m.domUtils.findIframeByWindow(t.source),s=new f(r,{offsetX:n,offsetY:i});s.maxScrollMargin=o,s.run().then(function(){return l.sendServiceMsg({cmd:c},t.source)})}});var f=(d.prototype._isScrollValuesChanged=function(t,e){return m.styleUtils.getScrollLeft(t)!==e.left||m.styleUtils.getScrollTop(t)!==e.top},d.prototype._setScroll=function(t,e){var n=this,i=e.left,o=e.top,r=m.domUtils.isHtmlElement(t)?m.domUtils.findDocument(t):t,s={left:m.styleUtils.getScrollLeft(r),top:m.styleUtils.getScrollTop(r)};i=Math.max(i,0),o=Math.max(o,0);var l=m.scrollController.waitForScroll(r);return m.styleUtils.setScrollLeft(r,i),m.styleUtils.setScrollTop(r,o),this._isScrollValuesChanged(r,s)?l=l.then(function(){n.scrollWasPerformed=n.scrollWasPerformed||n._isScrollValuesChanged(r,s)}):(l.cancel(),a.resolve())},d.prototype._getScrollToPoint=function(t,e,n){var i=e.x,o=e.y,r=Math.floor(t.width/2),s=Math.floor(Math.floor(t.height/2)),l=this.scrollToCenter?r:Math.min(n.left,r),a=this.scrollToCenter?s:Math.min(n.top,s),u=i>=t.scroll.left+t.width-l,c=i<=t.scroll.left+l,h=o>=t.scroll.top+t.height-a,f=o<=t.scroll.top+a,d=t.scroll.left,m=t.scroll.top;return u?d=i-t.width+l:c&&(d=i-l),h?m=o-t.height+a:f&&(m=o-a),{left:d,top:m}},d.prototype._getScrollToFullChildView=function(t,e,n){var i=null,o=null,r=t.width>=e.width,s=t.height>=e.height,l=m.positionUtils.calcRelativePosition(e,t);if(r){var a=t.width-e.width,u=Math.min(n.left,a);this.scrollToCenter&&(u=a/2),l.left<u?i=Math.round(t.scroll.left+l.left-u):l.right<u&&(i=Math.round(t.scroll.left+Math.min(l.left,-l.right)+u))}if(s){var c=t.height-e.height,h=Math.min(n.top,c);this.scrollToCenter&&(h=c/2),l.top<h?o=Math.round(t.scroll.top+l.top-h):l.bottom<h&&(o=Math.round(t.scroll.top+Math.min(l.top,-l.bottom)+h))}return{left:i,top:o}},d._getChildPoint=function(t,e,n){return{x:e.left-t.left+t.scroll.left+e.border.left+n.x,y:e.top-t.top+t.scroll.top+e.border.top+n.y}},d.prototype._getScrollPosition=function(t,e,n,i){var o=d._getChildPoint(t,e,n),r=this._getScrollToPoint(t,o,i),s=this._getScrollToFullChildView(t,e,i);return{left:Math.max(null===s.left?r.left:s.left,0),top:Math.max(null===s.top?r.top:s.top,0)}},d._getChildPointAfterScroll=function(t,e,n,i){return{x:Math.round(e.left+t.scroll.left-n.left+i.x),y:Math.round(e.top+t.scroll.top-n.top+i.y)}},d.prototype._isChildFullyVisible=function(t,e,n){var i=d._getChildPointAfterScroll(t,e,t.scroll,n),o=i.x,r=i.y,s=this._getScrollPosition(t,e,n,{left:0,top:0}),l=s.left,a=s.top;return!this._isTargetElementObscuredInPoint(o,r)&&l===t.scroll.left&&a===t.scroll.top},d.prototype._scrollToChild=function(t,e,n){for(var i=m.positionUtils.getClientDimensions(t),o=m.positionUtils.getClientDimensions(e),r=m.styleUtils.getInnerWidth(Fu),s=m.styleUtils.getInnerHeight(Fu),l=i.scroll,a=!this._isChildFullyVisible(i,o,n);a;){l=this._getScrollPosition(i,o,n,this.maxScrollMargin);var u=d._getChildPointAfterScroll(i,o,l,n),c=u.x,h=u.y,f=this._isTargetElementObscuredInPoint(c,h);this.maxScrollMargin.left+=20,this.maxScrollMargin.left>=r&&(this.maxScrollMargin.left=50,this.maxScrollMargin.top+=20),a=f&&this.maxScrollMargin.top<s}return this.maxScrollMargin={left:50,top:50},this._setScroll(t,l)},d.prototype._scrollElement=function(){if(!m.styleUtils.hasScroll(this.element))return a.resolve();var t=m.positionUtils.getClientDimensions(this.element),e=this._getScrollToPoint(t,{x:this.offsetX,y:this.offsetY},this.maxScrollMargin);return this._setScroll(this.element,e)},d.prototype._scrollParents=function(){var e=this,n=m.styleUtils.getScrollableParents(this.element),i=this.element,o=this.offsetX-Math.round(m.styleUtils.getScrollLeft(i)),r=this.offsetY-Math.round(m.styleUtils.getScrollTop(i)),s=null,l=null;return m.promiseUtils.times(n.length,function(t){return e._scrollToChild(n[t],i,{x:o,y:r}).then(function(){s=m.positionUtils.getClientDimensions(i),l=m.positionUtils.getClientDimensions(n[t]),o+=s.left-l.left+l.border.left,r+=s.top-l.top+l.border.top,i=n[t]})}).then(function(){return Fu.top===Fu||e.skipParentFrames?a.resolve():m.sendRequestToFrame({cmd:u,offsetX:o,offsetY:r,maxScrollMargin:e.maxScrollMargin},c,Fu.parent)})},d._getFixedAncestorOrSelf=function(t){return m.domUtils.findParent(t,!0,m.styleUtils.isFixedElement)},d.prototype._isTargetElementObscuredInPoint=function(t,e){var n=m.positionUtils.getElementFromPoint(t,e);if(!n)return!1;var i=d._getFixedAncestorOrSelf(n);return i&&!i.contains(this.element)},d.prototype.run=function(){var t=this;return this._scrollElement().then(function(){return t._scrollParents()}).then(function(){return t.scrollWasPerformed})},d);function d(t,e){this.element=t,this.offsetX=e.offsetX,this.offsetY=e.offsetY,this.scrollToCenter=e.scrollToCenter,this.skipParentFrames=e.skipParentFrames,this.raiseEvents=e.raiseEvents,this.maxScrollMargin={left:50,top:50},this.scrollWasPerformed=!1}var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function e(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var r=h.utils.browser;function s(t,e,n){var i=r.isFirefox?Math.ceil:Math.round,o=m.positionUtils.getOffsetPosition(t,i);return{x:(t===Lu.documentElement?0:o.left)+e,y:(t===Lu.documentElement?0:o.top)+n}}function p(t){if(!t)return null;var e=Fu.screenLeft||Fu.screenX,n=Fu.screenTop||Fu.screenY;return{x:e+t.x,y:n+t.y}}function n(t){var e=t/2;return e<1?0:Math.round(e)}function v(t){var e=m.positionUtils.getElementRectangle(t);return{offsetX:n(e.width),offsetY:n(e.height)}}function g(t,e,n){var i=v(t);if(e="number"==typeof e?Math.round(e):i.offsetX,n="number"==typeof n?Math.round(n):i.offsetY,0<e&&0<n)return{offsetX:e,offsetY:n};var o=m.positionUtils.getClientDimensions(t),r=Math.round(Math.max(t.scrollWidth,o.width)),s=Math.round(Math.max(t.scrollHeight,o.height)),l=o.scrollbar.right+o.border.left+o.border.right+r,a=o.scrollbar.bottom+o.border.top+o.border.bottom+s;return{offsetX:e<0?l+e:e,offsetY:n<0?a+n:n}}var y=E.domUtils,S=Fu.top===Fu?o.cursorUI:o.iframeCursorUI,b={x:-1,y:-1,currentActiveWindow:Fu.top,_ensureActiveWindow:function(){if(this.currentActiveWindow!==Fu&&this.currentActiveWindow!==Fu.parent){var t=y.findIframeByWindow(this.currentActiveWindow);t&&y.isElementInDocument(t)||(this.currentActiveWindow=Fu)}},get active(){return this._ensureActiveWindow(),this.currentActiveWindow===Fu},set activeWindow(t){this.currentActiveWindow=t},get activeWindow(){return this._ensureActiveWindow(),this.currentActiveWindow},get position(){return{x:this.x,y:this.y}},get visible(){return Fu.top===Fu&&S.isVisible()},move:function(t,e){return this.x=t,this.y=e,S.move(this.x,this.y)},hide:function(){this.visible&&S.hide()},show:function(){Fu.top===Fu&&S.show()},leftButtonDown:function(){return S.leftButtonDown()},rightButtonDown:function(){return S.rightButtonDown()},buttonUp:function(){return S.buttonUp()}},P=h.utils.browser,x=h.Promise,_=h.nativeMethods,A=E.positionUtils,C=E.domUtils;function w(t,e,n){var i=null;return o.hide(n).then(function(){return i=A.getElementFromPoint(t,e),o.show(n)}).then(function(){return i})}function T(t,e,n){var i=A.getElementFromPoint(t,e),o=C.containsElement(n,i)&&_.nodeTextContentGetter.call(i).length;return i&&i===n||o?i:null}function M(t,e){if(!e||!C.isDomElement(e)||!t||t===e)return t;if("tref"===C.getTagName(e))return e;var n,i,o,r="area"===C.getTagName(e)&&C.isImgElement(t);if(P.isFirefox&&r)return n=t,i=e,(o=C.closest(i,"map"))&&o.name===n.useMap.substring(1)?i:n;var s=C.isAnchorElement(e)||C.getParents(e,"a").length,l=s&&C.containsElement(e,t)&&_.nodeTextContentGetter.call(t).length;if(!s||l||!_.nodeTextContentGetter.call(e).length)return t;var a=e.getBoundingClientRect();return T(a.right-1,a.top+1,e)||T(a.left+1,a.bottom-1,e)||t}function U(n,i,o){var r=Fu!==Fu.top,s=null;return w(n,i).then(function(t){s=t;var e=x.resolve(t);return!s&&r&&0<n&&0<i&&(e=e.then(function(){return w(n,i,!0)}).then(function(t){return s=t})),e.then(function(t){return M(t,o)}).then(function(t){return{element:t,corrected:t!==s}})})}function D(){var t=b.position;return U(t.x,t.y).then(function(t){return t.element})}var I={elementIsInvisibleError:"elementIsInvisibleError",foundElementIsNotTarget:"foundElementIsNotTarget"},k=(Object.defineProperty(B.prototype,"mouseActionStepDelay",{get:function(){return 1===this.speedFactor?10:400*(1-this.speedFactor)},enumerable:!0,configurable:!0}),Object.defineProperty(B.prototype,"keyActionStepDelay",{get:function(){return 1===this.speedFactor?10:200*(1-this.speedFactor)},enumerable:!0,configurable:!0}),Object.defineProperty(B.prototype,"cursorSpeed",{get:function(){return Math.pow(400,this.speedFactor)/4},enumerable:!0,configurable:!0}),Object.defineProperty(B.prototype,"draggingSpeed",{get:function(){return Math.pow(16,this.speedFactor)/4},enumerable:!0,configurable:!0}),B);function B(t){this.speedFactor=t||1}var N=(O.prototype._getAssignableProperties=function(){throw new Error("Not implemented")},O.prototype._assignFrom=function(t,e,n){if(void 0===n&&(n={}),t)for(var i=this._getAssignableProperties(),o=0;o<i.length;o++){for(var r=i[o],s=r.name,l=r.type,a=r.required,u=r.init,c=r.defaultValue,h=s.split("."),f=h.length-1,d=h[f],m=t,p=this,v=0;v<f&&m&&p;v++)m=m[h[v]],p=p[h[v]];if(p&&"defaultValue"in i[o]&&(p[s]=c),m&&p){var g=m[d];void 0===g&&!a||(e&&l&&l(s,g),p[d]=u?u(s,g,n):g)}}},O);function O(){}function Y(i){return function(t,e){var n=typeof e;if("number"!=n)throw new i(t,n);if(isNaN(e)||!isFinite(e)||e!==Math.floor(e))throw new i(t,e)}}function F(t){this.code=t,this.isTestCafeError=!0,this.callsite=null}var L,K="E1",X="E2",V="E3",R="E4",W="E5",H="E6",G="E7",z="E8",q="E9",j="E10",$="E11",Z="E12",J="E14",Q="E15",tt="E16",et="E17",nt="E18",it="E19",ot="E20",rt="E21",st="E22",lt="E23",at="E24",ut="E26",ct="E27",ht="E28",ft="E29",dt="E30",mt="E31",pt="E32",vt="E33",gt="E34",Et="E35",yt="E36",St="E37",bt="E38",Pt="E39",xt="E40",_t="E41",At="E42",Ct="E43",wt="E44",Tt="E45",Mt="E46",Ut="E47",Dt="E48",It="E49",kt="E50",Bt="E51",Nt="E52",Ot="E53",Yt="E54",Ft="E55",Lt="E56",Kt="E57",Xt="E58",Vt="E59",Rt="E60",Wt="E61",Ht="E62",Gt="E63",zt="E64",qt="E65",jt="E66",$t="E67",Zt="E68",Jt="E69",Qt="E70",te="E71",ee="E72",ne=(e(ie,L=F),ie);function ie(t,e,n){var i=L.call(this,t)||this;return i.optionName=e,i.actualValue=n,i}var oe,re,se,le,ae=(e(ue,oe=F),ue);function ue(t,e,n){var i=oe.call(this,t)||this;return i.argumentName=e,i.actualValue=n,i}function ce(t){var e=re.call(this,z)||this;return e.callsite=t,e}function he(t){var e=se.call(this,It)||this;return e.instantiationCallsiteName=t,e}function fe(t){var e=le.call(this,kt)||this;return e.instantiationCallsiteName=t,e}e(ce,re=F),e(he,se=F),e(fe,le=F);var de,me,pe,ve,ge,Ee,ye,Se,be,Pe,xe,_e,Ae,Ce,we,Te,Me,Ue=(e(De,de=F),De);function De(t,e){var n=e.apiFnChain,i=e.apiFnIndex,o=de.call(this,t)||this;return o.apiFnChain=n,o.apiFnIndex=i,o}function Ie(){return me.call(this,Bt)||this}function ke(t,e){var n=pe.call(this,Nt,e)||this;return n.callsite=t,n}function Be(t,e){var n=ve.call(this,Yt)||this;return n.url=e,n.errMsg=t,n}function Ne(t,e){var n=ge.call(this,K)||this;return n.errStack=t,n.pageDestUrl=e,n}function Oe(t,e){var n=Ee.call(this,X)||this;return n.errMsg=String(t.rawMessage||t),n.callsite=t.callsite||e,n.originError=t,n}function Ye(t){var e=ye.call(this,V)||this;return e.objType=typeof t,e.objStr=String(t),e}function Fe(t,e){var n=Se.call(this,R)||this;return n.errMsg=String(e),n.instantiationCallsiteName=t,n}function Le(t,e,n){var i=be.call(this,W,e,n)||this;return i.errMsg=String(e),i.property=n,i.instantiationCallsiteName=t,i}function Ke(t){var e=Pe.call(this,H)||this;return e.errMsg=String(t),e}function Xe(t){var e=xe.call(this,G)||this;return e.errMsg=String(t),e}function Ve(t){var e=_e.call(this,zt)||this;return e.errMsg=String(t),e}function Re(t,e){var n=Ae.call(this,qt)||this;return n.errMsg=String(t),n.moduleName=e,n}function We(t,e){var n=Ce.call(this,Ot)||this;return n.errMsg=String(t),n.callsite=e,n}function He(t,e,n,i){var o=we.call(this,Vt,t,e)||this;return o.errMsg=i?n.rawMessage:n.message,o.originError=n,o}function Ge(t){var e=Te.call(this,Rt)||this;return e.callsite=t,e}function ze(t){var e=Me.call(this,Wt)||this;return e.callsite=t,e}e(Ie,me=F),e(ke,pe=Ue),e(Be,ve=F),e(Ne,ge=F),e(Oe,Ee=F),e(Ye,ye=F),e(Fe,Se=F),e(Le,be=F),e(Ke,Pe=F),e(Xe,xe=F),e(Ve,_e=F),e(Re,Ae=F),e(We,Ce=F),e(He,we=ae),e(Ge,Te=F),e(ze,Me=F);var qe,je=(e($e,qe=ne),$e);function $e(t,e){return qe.call(this,q,t,e)||this}var Ze,Je=(e(Qe,Ze=ne),Qe);function Qe(t,e){return Ze.call(this,j,t,e)||this}var tn,en,nn=(e(on,tn=ne),on);function on(t,e){return tn.call(this,$,t,e)||this}function rn(t,e){return en.call(this,Q,t,e)||this}e(rn,en=ae);var sn,ln,an,un,cn,hn,fn,dn,mn,pn,vn,gn,En,yn,Sn,bn,Pn,xn,_n,An,Cn,wn,Tn,Mn,Un,Dn,In,kn,Bn,Nn,On,Yn,Fn,Ln,Kn,Xn,Vn,Rn,Wn,Hn,Gn,zn,qn,jn,$n,Zn,Jn,Qn=(e(ti,sn=ne),ti);function ti(t,e){return sn.call(this,Z,t,e)||this}function ei(t){var e=ln.call(this,J)||this;return e.actualType=t,e}function ni(t,e){return an.call(this,tt,t,e)||this}function ii(t,e){return un.call(this,et,t,e)||this}function oi(t,e){return cn.call(this,ot,t,e)||this}function ri(t,e){return hn.call(this,rt,t,e)||this}function si(t,e){return fn.call(this,st,t,e)||this}function li(t,e){return dn.call(this,nt,t,e)||this}function ai(t,e,n){var i=mn.call(this,it,t,e)||this;return i.elementIndex=n,i}function ui(t,e){return pn.call(this,Ut,t,e)||this}function ci(t,e){return vn.call(this,bt,t,e)||this}function hi(t,e,n){var i=gn.call(this,lt)||this;return i.selectorName=t,i.errMsg=n?e.rawMessage:e.message,i.originError=e,i}function fi(t){return En.call(this,at,t)||this}function di(){return yn.call(this,ut)||this}function mi(t){var e=Sn.call(this,ct)||this;return e.nodeDescription=t,e}function pi(t,e){var n=bn.call(this,ht,e)||this;return n.argumentName=t,n}function vi(t){var e=Pn.call(this,ft)||this;return e.argumentName=t,e}function gi(t,e){var n=xn.call(this,dt)||this;return n.argumentName=t,n.nodeDescription=e,n}function Ei(){return _n.call(this,mt)||this}function yi(){return An.call(this,pt)||this}function Si(t){var e=Cn.call(this,vt)||this;return e.argumentName=t,e}function bi(){return wn.call(this,Et)||this}function Pi(t){var e=Tn.call(this,yt)||this;return e.argumentName=t,e}function xi(t){var e=Mn.call(this,St)||this;return e.filePaths=t,e}function _i(){return Un.call(this,gt)||this}function Ai(t,e){var n=Dn.call(this,_t)||this;return n.properties=t?"scrollTargetY property":e?"scrollTargetX property":"scrollTargetX and scrollTargetY properties",n}function Ci(t,e,n,i,o){var r=In.call(this,jt)||this;return r.callsite=o,r.expression=e,r.line=n,r.column=i,r.originError=t,r.errMsg=t.message||String(t),r}function wi(t,e,n,i,o){var r=kn.call(this,$t)||this;return r.callsite=o,r.expression=e,r.line=n,r.column=i,r.originError=t,r.errCallsite=t.callsite,r}function Ti(t){var e=Bn.call(this,Ft)||this;return e.callsite=t,e}function Mi(t,e){var n=Nn.call(this,Kt)||this;return t<=0?e<=0?(n.verb="are",n.dimensions="width and height"):(n.verb="is",n.dimensions="width"):(n.verb="is",n.dimensions="height"),n}function Ui(t,e){var n=On.call(this,Lt)||this;return n.screenshotPath=t,n.forbiddenCharsList=e,n}function Di(t){var e=Yn.call(this,Xt)||this;return e.callsite=t,e}function Ii(){return Fn.call(this,xt)||this}function ki(){return Ln.call(this,Pt)||this}function Bi(){return Kn.call(this,At)||this}function Ni(){return Xn.call(this,Jt)||this}function Oi(){return Vn.call(this,Zt)||this}function Yi(){return Rn.call(this,Qt)||this}function Fi(){return Wn.call(this,te)||this}function Li(){return Hn.call(this,Ct)||this}function Ki(){return Gn.call(this,wt)||this}function Xi(t,e){var n=zn.call(this,Tt)||this;return n.dialogType=t,n.pageUrl=e,n}function Vi(t,e,n){var i=qn.call(this,Mt)||this;return i.dialogType=t,i.errMsg=e,i.pageUrl=n,i}function Ri(t){var e=jn.call(this,Dt)||this;return e.actualType=t,e}function Wi(t,e,n){var i=$n.call(this,Gt)||this;return i.errMsg=String(t),i.hookClassName=e,i.methodName=n,i}function Hi(t,e){var n=Zn.call(this,Ht)||this;return n.methodName=t,n.hookClassName=e,n}function Gi(){return Jn.call(this,ee)||this}e(ei,ln=F),e(ni,an=ae),e(ii,un=ae),e(oi,cn=ae),e(ri,hn=ae),e(si,fn=ae),e(li,dn=ae),e(ai,mn=ae),e(ui,pn=ae),e(ci,vn=ae),e(hi,gn=F),e(fi,En=Ue),e(di,yn=F),e(mi,Sn=F),e(pi,bn=Ue),e(vi,Pn=F),e(gi,xn=F),e(Ei,_n=F),e(yi,An=F),e(Si,Cn=F),e(bi,wn=F),e(Pi,Tn=F),e(xi,Mn=F),e(_i,Un=F),e(Ai,Dn=F),e(Ci,In=F),e(wi,kn=F),e(Ti,Bn=F),e(Mi,Nn=F),e(Ui,On=F),e(Di,Yn=F),e(Ii,Fn=F),e(ki,Ln=F),e(Bi,Kn=F),e(Ni,Xn=F),e(Oi,Vn=F),e(Yi,Rn=F),e(Fi,Wn=F),e(Li,Hn=F),e(Ki,Gn=F),e(Xi,zn=F),e(Vi,qn=F),e(Ri,jn=F),e(Wi,$n=F),e(Hi,Zn=F),e(Gi,Jn=F);var zi,qi,ji,$i,Zi,Ji=Y(je),Qi=(qi=Y(zi=Je),function(t,e){if(qi(t,e),e<0)throw new zi(t,e)}),to=(ji=nn,function(t,e){var n=typeof e;if("boolean"!=n)throw new ji(t,n)}),eo=($i=Qn,function(t,e){var n=typeof e;if("number"!=n)throw new $i(t,n);if(isNaN(e)||e<.01||1<e)throw new $i(t,e)}),no=(e(io,Zi=N),io.prototype._getAssignableProperties=function(){return[{name:"speed",type:eo}]},io);function io(t,e){var n=Zi.call(this)||this;return n.speed=null,n._assignFrom(t,e),n}var oo,ro=(e(so,oo=no),so.prototype._getAssignableProperties=function(){return oo.prototype._getAssignableProperties.call(this).concat([{name:"offsetX",type:Ji},{name:"offsetY",type:Ji}])},so);function so(t,e){var n=oo.call(this)||this;return n.offsetX=null,n.offsetY=null,n._assignFrom(t,e),n}var lo,ao,uo=(e(co,lo=ro),co.prototype._getAssignableProperties=function(){return lo.prototype._getAssignableProperties.call(this).concat([{name:"scrollToCenter",type:to},{name:"skipParentFrames",type:to}])},co);function co(t,e){var n=lo.call(this)||this;return n.scrollToCenter=!1,n.skipParentFrames=!1,n._assignFrom(t,e),n}function ho(t,e){var n=ao.call(this)||this;return n.scrollTargetX=null,n.scrollTargetY=null,n.includeMargins=!1,n.includeBorders=!0,n.includePaddings=!0,n.crop={left:null,right:null,top:null,bottom:null},n._assignFrom(t,e),n}e(ho,ao=no),ho.prototype._getAssignableProperties=function(){return ao.prototype._getAssignableProperties.call(this).concat([{name:"scrollTargetX",type:Ji},{name:"scrollTargetY",type:Ji},{name:"crop.left",type:Ji},{name:"crop.right",type:Ji},{name:"crop.top",type:Ji},{name:"crop.bottom",type:Ji},{name:"includeMargins",type:to},{name:"includeBorders",type:to},{name:"includePaddings",type:to}])};var fo,mo=(e(po,fo=ro),po.prototype._getAssignableProperties=function(){return fo.prototype._getAssignableProperties.call(this).concat([{name:"modifiers.ctrl",type:to},{name:"modifiers.alt",type:to},{name:"modifiers.shift",type:to},{name:"modifiers.meta",type:to}])},po);function po(t,e){var n=fo.call(this)||this;return n.modifiers={ctrl:!1,alt:!1,shift:!1,meta:!1},n._assignFrom(t,e),n}var vo,go=(e(Eo,vo=mo),Eo.prototype._getAssignableProperties=function(){return vo.prototype._getAssignableProperties.call(this).concat([{name:"caretPos",type:Qi}])},Eo);function Eo(t,e){var n=vo.call(this)||this;return n.caretPos=null,n._assignFrom(t,e),n}var yo,So=(e(bo,yo=mo),bo.prototype._getAssignableProperties=function(){return yo.prototype._getAssignableProperties.call(this).concat([{name:"speed"},{name:"minMovingTime"},{name:"holdLeftButton"},{name:"skipScrolling",type:to},{name:"skipDefaultDragBehavior",type:to}])},bo);function bo(t,e){var n=yo.call(this)||this;return n.speed=null,n.minMovingTime=null,n.holdLeftButton=!1,n.skipScrolling=!1,n.skipDefaultDragBehavior=!1,n._assignFrom(t,e),n}var Po,xo,_o,Ao,Co=(e(wo,Po=go),wo.prototype._getAssignableProperties=function(){return Po.prototype._getAssignableProperties.call(this).concat([{name:"replace",type:to},{name:"paste",type:to}])},wo);function wo(t,e){var n=Po.call(this)||this;return n.replace=!1,n.paste=!1,n._assignFrom(t,e),n}function To(t,e){var n=xo.call(this,t,e)||this;return n.destinationOffsetX=null,n.destinationOffsetY=null,n._assignFrom(t,e),n}function Mo(t,e){var n=_o.call(this)||this;return n.portraitOrientation=!1,n._assignFrom(t,e),n}function Uo(t,e){var n=Ao.call(this)||this;return n.timeout=void 0,n.allowUnawaitedPromise=!1,n._assignFrom(t,e),n}function Do(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Io(t,e,n){var i=null;if(n.isHorizontal)return(i=m.positionUtils.getLineXByYCoord(t,e,n.y1))&&i>=n.x1&&i<=n.x2?{x:i,y:n.y1}:null;var o=m.positionUtils.getLineYByXCoord(t,e,n.x1);return o&&o>=n.y1&&o<=n.y2?{x:n.x1,y:o}:null}function ko(t,e,n){for(var i=[],o=null,r=[{x1:n.left,y1:n.top,x2:n.left,y2:n.bottom,isHorizontal:!1},{x1:n.right,y1:n.top,x2:n.right,y2:n.bottom,isHorizontal:!1},{x1:n.left,y1:n.top,x2:n.right,y2:n.top,isHorizontal:!0},{x1:n.left,y1:n.bottom,x2:n.right,y2:n.bottom,isHorizontal:!0}],s=0;s<r.length;s++)(o=Io(t,e,r[s]))&&i.push(o);return i.length?1===i.length||Do(t,i[0])<Do(t,i[1])?i[0]:i[1]:null}e(To,xo=mo),To.prototype._getAssignableProperties=function(){return xo.prototype._getAssignableProperties.call(this).concat([{name:"destinationOffsetX",type:Ji},{name:"destinationOffsetY",type:Ji}])},e(Mo,_o=N),Mo.prototype._getAssignableProperties=function(){return[{name:"portraitOrientation",type:to}]},e(Uo,Ao=N),Uo.prototype._getAssignableProperties=function(){return[{name:"timeout",type:Qi},{name:"allowUnawaitedPromise",type:to}]};var Bo=h.Promise,No=h.nativeMethods;function Oo(){return new Bo(function(t){return No.setTimeout.call(Fu,t,0)})}var Yo=function(){this.enabled=!1,this.dropAllowed=!1,this.element=null,this.dataTransfer=null,this.dataStore=null},Fo=h.utils.browser,Lo=(Ko.prototype.setup=function(){this.dragAndDropMode=!1,this.dropAllowed=!1},Ko.prototype.leaveElement=function(){},Ko.prototype.move=function(){},Ko.prototype.enterElement=function(){},Ko.prototype.dragAndDrop=function(){},Ko.prototype.teardown=function(){},Ko.prototype.run=function(t,e,n,i,o){var r=e&&m.domUtils.isElementInDocument(e),s=e&&m.domUtils.isElementInIframe(e)&&!m.domUtils.getIframeByElement(e);r&&!s||(e=null);var l=t!==e,a=l?m.domUtils.getCommonAncestor(t,e):null;this.setup(),l&&e&&this.leaveElement(t,e,a,n),Fo.isIE&&this.move(t,n),l&&m.domUtils.isElementInDocument(t)&&this.enterElement(t,e,a,n),Fo.isIE||this.move(t,n),this.dragAndDrop(i,t,e,n,o),this.teardown(t,n,e);var u=this.dragAndDropMode,c=this.dropAllowed;return this.dragAndDropMode=!1,this.dropAllowed=!1,{dragAndDropMode:u,dropAllowed:c}},Ko);function Ko(t){var e=t.moveEvent;this.dragAndDropMode=!1,this.dropAllowed=!1,this.moveEvent=e}var Xo=h.eventSandbox.eventSimulator,Vo=h.utils.extend,Ro=h.nativeMethods,Wo=(Ho.leaveElement=function(t,e,n,i){Xo.mouseout(e,Vo({relatedTarget:t},i));for(var o=e;o&&o!==n;)Xo.mouseleave(o,Vo({relatedTarget:t},i)),o=Ro.nodeParentNodeGetter.call(o)},Ho.enterElement=function(t,e,n,i){Xo.mouseover(t,Vo({relatedTarget:e},i));for(var o=t,r=[];o&&o!==n;)r.push(o),o=Ro.nodeParentNodeGetter.call(o);r.reverse();for(var s=0;s<r.length;s++)Xo.mouseenter(r[s],Vo({relatedTarget:e},i))},Ho.move=function(t,e,n){Xo[t](e,n)},Ho);function Ho(){}var Go=(zo.dragAndDrop=function(t,e,n,i){return Xo.drag(t,i),e!==n&&(m.domUtils.isElementInDocument(e)&&(i.relatedTarget=n,Xo.dragenter(e,i)),n&&(i.relatedTarget=e,Xo.dragleave(n,i))),!Xo.dragover(e,i)},zo);function zo(){}var qo,jo=h.eventSandbox.eventSimulator,$o=(e(Zo,qo=Lo),Zo.prototype.leaveElement=function(t,e,n,i){Wo.leaveElement(t,e,n,i)},Zo.prototype.enterElement=function(t,e,n,i){Wo.enterElement(t,e,n,i)},Zo.prototype.move=function(t,e){this._needEmulateMoveEvent()&&Wo.move(this.moveEvent,t,e)},Zo.prototype.teardown=function(t,e,n){this._needEmulateMoveEvent()&&m.domUtils.isElementInDocument(t)&&t!==n&&jo[this.moveEvent](t,e)},Zo.prototype._needEmulateMoveEvent=function(){return"touchmove"!==this.moveEvent||this.holdLeftButton},Zo);function Zo(t){var e=qo.call(this,t)||this;return e.holdLeftButton=t.holdLeftButton,e}var Jo,Qo=(e(tr,Jo=Lo),tr.prototype.setup=function(){Jo.prototype.setup.call(this),this.dragAndDropMode=!0},tr.prototype.dragAndDrop=function(t,e,n,i){this.dropAllowed=Go.dragAndDrop(t,e,n,i)},tr);function tr(){return null!==Jo&&Jo.apply(this,arguments)||this}var er,nr=h.eventSandbox.eventSimulator,ir=(e(or,er=Lo),or.prototype.setup=function(){er.prototype.setup.call(this),this.dragAndDropMode=!0},or.prototype.leaveElement=function(t,e,n,i){Wo.leaveElement(t,e,n,i)},or.prototype.move=function(t,e){Wo.move(this.moveEvent,t,e)},or.prototype.enterElement=function(t,e,n,i){Wo.enterElement(t,e,n,i)},or.prototype.dragAndDrop=function(t,e,n,i,o){var r=nr.dragstart(t,i);o.setReadOnlyMode(),r?this.dropAllowed=Go.dragAndDrop(t,e,n,i):this.dragAndDropMode=!1},or.prototype.run=function(t,e,n,i,o){return er.prototype.run.call(this,t,null,n,i,o)},or);function or(){return null!==er&&er.apply(this,arguments)||this}var rr=null,sr=function(){return rr},lr=function(t){rr=t},ar=h.Promise,ur=h.nativeMethods,cr=h.utils.featureDetection,hr=h.utils.html,fr=h.utils.url,dr=h.eventSandbox.eventSimulator,mr=h.eventSandbox.message,pr=h.eventSandbox.DataTransfer,vr=h.eventSandbox.DragDataStore,gr=E.positionUtils,Er=E.domUtils,yr=E.styleUtils,Sr=E.eventUtils,br=E.promiseUtils,Pr=E.sendRequestToFrame,xr="automation|move|request",_r="automation|move|response";mr.on(mr.SERVICE_MSG_RECEIVED_EVENT,function(t){t.message.cmd===xr&&(t.source.parent===Fu?Ar.onMoveToIframeRequest(t):(h.on(h.EVENTS.beforeUnload,function(){return mr.sendServiceMsg({cmd:_r},t.source)}),Ar.onMoveOutRequest(t)))});var Ar=(Cr.getTarget=function(t,e,n){var i=!gr.containsOffset(t,e,n),o=i?s(t,e,n):{x:e,y:n};return{element:i?Lu.documentElement:t,offsetX:o.x,offsetY:o.y}},Cr.onMoveToIframeRequest=function(t){var e={x:t.message.endX,y:t.message.endY},n=t.source,i=Er.findIframeByWindow(n),o=yr.getBordersWidth(i),r=yr.getElementPadding(i),s=gr.getIframeClientCoordinates(i),l=gr.getIframePointRelativeToParentFrame(e,n),a=b.position,u=gr.isInRectangle(a,s)?a:ko(a,l,s),c={x:u.x-s.left,y:u.y-s.top},h=new Cr(i,new So({modifiers:t.message.modifiers,offsetX:c.x+o.left+r.left,offsetY:c.y+o.top+r.top,speed:t.message.speed,skipScrolling:!0},!1)),f={cmd:_r,x:c.x,y:c.y};b.activeWindow!==n?h.run().then(function(){b.activeWindow=n,mr.sendServiceMsg(f,n)}):mr.sendServiceMsg(f,n)},Cr.onMoveOutRequest=function(t){var e=t.source,n={left:t.message.left,right:t.message.right,top:t.message.top,bottom:t.message.bottom};if(!t.message.iframeUnderCursor){var i=t.message,o=i.startX,r=i.startY,s=o-n.left,l=r-n.top,a=sr();return a&&(dr.mouseout(a,{clientX:s,clientY:l,relatedTarget:null}),dr.mouseleave(a,{clientX:s,clientY:l,relatedTarget:null})),void mr.sendServiceMsg({cmd:_r},e)}var u=b.position,c=ko({x:n.left+u.x,y:n.top+u.y},{x:t.message.endX,y:t.message.endY},n);if(c){var h=new So({modifiers:t.message.modifiers,offsetX:c.x-n.left,offsetY:c.y-n.top,speed:t.message.speed,skipScrolling:!0},!1);new Cr(Lu.documentElement,h).run().then(function(){var t={cmd:_r,x:c.x,y:c.y};b.activeWindow=e,mr.sendServiceMsg(t,e)})}else mr.sendServiceMsg({cmd:_r,x:n.left,y:n.top},e)},Cr.prototype._getTargetClientPoint=function(){var t=yr.getElementScroll(this.element);if(Er.isHtmlElement(this.element))return{x:Math.floor(this.offsetX-t.left),y:Math.floor(this.offsetY-t.top)};var e=gr.getClientPosition(this.element),n=this.element.tagName&&Er.isBodyElement(this.element);return{x:Math.floor(n?e.x+this.offsetX:e.x+this.offsetX-t.left),y:Math.floor(n?e.y+this.offsetY:e.y+this.offsetY-t.top)}},Cr.prototype._emulateEvents=function(t){var e,n,i=this.holdLeftButton?Sr.BUTTONS_PARAMETER.leftButton:Sr.BUTTONS_PARAMETER.noButton,o=p({x:this.x,y:this.y}),r={clientX:this.x,clientY:this.y,screenX:o.x,screenY:o.y,buttons:i,ctrl:this.modifiers.ctrl,alt:this.modifiers.alt,shift:this.modifiers.shift,meta:this.modifiers.meta,dataTransfer:this.dragAndDropState.dataTransfer},s={moveEvent:this.moveEvent,holdLeftButton:this.holdLeftButton},l=(e=this.dragAndDropState.enabled,n=this.firstMovingStepOccured,new(e?n?Qo:ir:$o)(s).run(t,sr(),r,this.dragElement,this.dragAndDropState.dataStore)),a=l.dragAndDropMode,u=l.dropAllowed;this.firstMovingStepOccured=!0,this.dragAndDropState.enabled=a,this.dragAndDropState.dropAllowed=u,lr(t)},Cr.prototype._movingStep=function(){var n=this;if(this.touchMode&&!this.holdLeftButton)this.x=this.endPoint.x,this.y=this.endPoint.y;else if(this.startTime){var t=(Math.min(ur.dateNow(),this.endTime)-this.startTime)/(this.endTime-this.startTime);this.x=Math.floor(this.startPoint.x+this.distanceX*t),this.y=Math.floor(this.startPoint.y+this.distanceY*t)}else this.startTime=ur.dateNow(),this.endTime=this.startTime+this.movingTime,this.x+=0<this.distanceX?1:-1,this.y+=0<this.distanceY?1:-1;return b.move(this.x,this.y).then(D).then(function(t){var e=n.holdLeftButton&&n.touchMode?n.dragElement:t;return e?n._emulateEvents(e):null}).then(Oo)},Cr.prototype._isMovingFinished=function(){return this.x===this.endPoint.x&&this.y===this.endPoint.y},Cr.prototype._move=function(){var t=this;return this.startPoint=b.position,this.x=this.startPoint.x,this.y=this.startPoint.y,this.distanceX=this.endPoint.x-this.startPoint.x,this.distanceY=this.endPoint.y-this.startPoint.y,this.movingTime=Math.max(Math.abs(this.distanceX),Math.abs(this.distanceY))/this.cursorSpeed,this.minMovingTime&&(this.movingTime=Math.max(this.movingTime,this.minMovingTime)),br.whilst(function(){return!t._isMovingFinished()},function(){return t._movingStep()})},Cr.prototype._scroll=function(){if(this.skipScrolling)return ar.resolve();var t=new uo({offsetX:this.offsetX,offsetY:this.offsetY},!1);return new f(this.element,t).run()},Cr.prototype._moveToCurrentFrame=function(){if(b.active)return ar.resolve();var t=b.position,e=t.x,n=t.y,i=b.activeWindow,o=null,r=null,s=null,l={cmd:xr,startX:e,startY:n,endX:this.endPoint.x,endY:this.endPoint.y,modifiers:this.modifiers,speed:this.speed};return i.parent===Fu&&(o=Er.findIframeByWindow(i),s=gr.getIframeClientCoordinates(o),l.left=s.left,l.top=s.top,l.right=s.right,l.bottom=s.bottom),D().then(function(t){return r=t===o,i.parent===Fu&&(l.iframeUnderCursor=r),Pr(l,_r,i)}).then(function(t){return b.activeWindow=Fu,r||Fu.top!==Fu?b.move(t.x,t.y):null})},Cr.prototype.run=function(){var l=this;return D().then(function(t){l.dragElement=l.holdLeftButton?t:null;var e=function(t){for(var e=t;e;){if(e.draggable)return e;e=ur.nodeParentNodeGetter.call(e)}return null}(l.dragElement);if(e&&cr.hasDataTransfer&&!l.skipDefaultDragBehavior){l.dragAndDropState.enabled=!0,l.dragElement=e,l.dragAndDropState.element=l.dragElement,l.dragAndDropState.dataStore=new vr,l.dragAndDropState.dataTransfer=new pr(l.dragAndDropState.dataStore);var n=Er.isAnchorElement(l.dragElement);if(n||Er.isImgElement(l.dragElement)){var i=n?"href":"src",o=fr.parseProxyUrl(l.dragElement[i]),r=o?o.destUrl:l.dragElement[i],s=hr.cleanUpHtml(ur.elementOuterHTMLGetter.call(l.dragElement));l.dragAndDropState.dataTransfer.setData("text/plain",r),l.dragAndDropState.dataTransfer.setData("text/uri-list",r),l.dragAndDropState.dataTransfer.setData("text/html",s)}}return l._scroll()}).then(function(){var t=l._getTargetClientPoint(),e=t.x,n=t.y,i=yr.getWidth(Fu),o=yr.getHeight(Fu);return 0<=e&&e<=i&&0<=n&&n<=o?(l.endPoint={x:e,y:n},l._moveToCurrentFrame().then(function(){return l._move()})):null}).then(function(){return l.dragAndDropState})},Cr);function Cr(t,e){this.touchMode=cr.isTouchDevice,this.moveEvent=this.touchMode?"touchmove":"mousemove",this.holdLeftButton=e.holdLeftButton,this.dragElement=null,this.dragAndDropState=new Yo,this.automationSettings=new k(e.speed);var n=Cr.getTarget(t,e.offsetX,e.offsetY);this.element=n.element,this.offsetX=n.offsetX,this.offsetY=n.offsetY,this.speed=e.speed,this.cursorSpeed=this.holdLeftButton?this.automationSettings.draggingSpeed:this.automationSettings.cursorSpeed,this.minMovingTime=e.minMovingTime||null,this.modifiers=e.modifiers||{},this.skipScrolling=e.skipScrolling,this.skipDefaultDragBehavior=e.skipDefaultDragBehavior,this.endPoint=null,this.movingTime=null,this.x=null,this.y=null,this.startTime=null,this.endTime=null,this.distanceX=null,this.distanceY=null,this.firstMovingStepOccured=!1}var wr,Tr=h.utils.extend,Mr=function(t){var e=t.element,n=void 0===e?null:e,i=t.clientPoint,o=void 0===i?null:i,r=t.screenPoint,s=void 0===r?null:r,l=t.isTarget,a=void 0!==l&&l,u=t.inMoving,c=void 0!==u&&u;this.element=n,this.clientPoint=o,this.screenPoint=s,this.isTarget=a,this.inMoving=c,this.devicePoint=p(o)},Ur=(e(Dr,wr=m.serviceUtils.EventEmitter),Dr.prototype._getElementForEvent=function(t){var e=t.point;return U(e.x,e.y,m.positionUtils.containsOffset(this.element,this.options.offsetX,this.options.offsetY)?this.element:null).then(function(t){return t.element})},Dr.prototype._moveToElement=function(){var t=this,e=new So(Tr({skipScrolling:!0},this.options),!1);return new Ar(this.element,e).run().then(function(){return m.delay(t.automationSettings.mouseActionStepDelay)})},Dr.prototype._scrollToElement=function(){var s=this,t=new uo(this.options),e=new f(this.element,t),l=!1;return e.run().then(function(t){return l=t,m.delay(s.automationSettings.mouseActionStepDelay)}).then(D).then(function(t){if(!t||!m.domUtils.contains(s.element,t)||!l)return null;var e=sr(),n=m.domUtils.getCommonAncestor(t,e),i=m.positionUtils.getClientPosition(t),o=p({x:i.x,y:i.y}),r={clientX:i.x,clientY:i.y,screenX:o.x,screenY:o.y,ctrl:!1,alt:!1,shift:!1,meta:!1,buttons:m.eventUtils.BUTTONS_PARAMETER.leftButton};return Wo.leaveElement(t,e,n,r),Wo.enterElement(t,e,n,r),lr(t),l})},Dr.prototype._getElementOffset=function(){var t=g(this.element),e=this.options,n=e.offsetX,i=e.offsetY;return{offsetX:n=n||0===n?n:t.offsetX,offsetY:i=i||0===i?i:t.offsetY}},Dr.prototype._wrapAction=function(t){var h=this,e=this._getElementOffset(),i=e.offsetX,o=e.offsetY,f=s(this.element,i,o),d=m.positionUtils.getClientPosition(this.element);return t().then(function(){var t,e,n,l=s(h.element,i,o),a=m.positionUtils.getClientPosition(h.element),u=(t=h.element,e=l,n=m.styleUtils.getElementScroll(t),!/html/i.test(t.tagName)&&m.styleUtils.hasScroll(t)&&(e.x-=n.left,e.y-=n.top),m.positionUtils.offsetToClientCoords(e)),c=m.positionUtils.containsOffset(h.element,i,o)?h.element:null;return U(u.x,u.y,c).then(function(t){var e=t.element,n=t.corrected,i=e;if(!i)return new Mr({});var o=!c||n||i===h.element;o=o||-1<m.arrayUtils.indexOf(m.domUtils.getParents(i),h.element);var r=f.x!==l.x||f.y!==l.y,s=d.x!==a.x||d.y!==a.y;return new Mr({element:e,clientPoint:u,screenPoint:l,isTarget:o,inMoving:r&&s})})})},Dr._checkElementState=function(t,e){if(!t.element)throw new Error(I.elementIsInvisibleError);if(e&&(!t.isTarget||t.inMoving))throw new Error(I.foundElementIsNotTarget)},Dr.prototype._ensureElement=function(e,n){var i=this;return this._wrapAction(function(){return i._scrollToElement()}).then(function(t){return Dr._checkElementState(t,e)}).then(function(){return i._wrapAction(function(){return i._moveToElement()})}).then(function(t){return n||Dr._checkElementState(t,e),t}).then(function(t){return i.emit(i.TARGET_ELEMENT_FOUND_EVENT,{element:t.element}),{element:t.element,clientPoint:t.clientPoint,screenPoint:t.screenPoint,devicePoint:t.devicePoint}})},Dr);function Dr(t,e){var n=wr.call(this)||this;return n.TARGET_ELEMENT_FOUND_EVENT="automation|target-element-found-event",n.element=t,n.options=e,n.automationSettings=new k(e.speed),n}var Ir=h.Promise,kr=h.nativeMethods,Br=h.utils.browser,Nr=h.eventSandbox.focusBlur,Or=E.contentEditable,Yr=E.textSelection,Fr=E.domUtils,Lr=E.styleUtils;function Kr(p,v,g){return new Ir(function(t){var e,n=Fr.getActiveElement(),i=Fr.isTextEditableElement(p),o=Fr.closest(p,"label[for]"),r=Fr.isElementFocusable(p),s=!r&&o,l=Fr.isContentEditableElement(p),a=l?Or.findContentEditableParent(p):p;if(v&&Br.isWebKit&&i&&Yr.select(p,0,0),s)return v&&(e=o,Fr.isElementFocusable(e)?Nr.focus(e,E.noop,!1,!0):Vr(e)),void t();var u=!v,c=!1;if(!r&&!l){var h=Fr.findDocument(a),f=kr.documentActiveElementGetter.call(h),d=Fr.isBodyElement(f),m=Fr.isBodyElement(a)?a:Fr.getFocusableParent(a);if(f&&!d&&Fr.containsElement(f,a)||d&&Fr.isBodyElement(m))return void t();a=m||h.body,c=!0}Nr.focus(a,function(){!v||l||p===Fr.getActiveElement()?(function(t,e){var n=Fr.isTextEditableElement(t),i=Fr.isContentEditableElement(t);if(n||i)if(i&&isNaN(parseInt(e,10)))Yr.setCursorToLastVisiblePosition(t);else{var o=isNaN(parseInt(e,10))?Fr.getElementValue(t).length:e;Yr.select(t,o,o)}else{var r=Or.findContentEditableParent(t);r&&Yr.setCursorToLastVisiblePosition(Or.findContentEditableParent(r))}}(p,g),v||Fr.getActiveElement()===n?t():Nr.focus(n,t,!0,!0)):t()},u,!0,!1,c)})}function Xr(t){var e=Fr.closest(t,"label[for]"),n=e&&(e.control||Lu.getElementById(e.htmlFor));return n&&Lr.isElementVisible(n)?n:null}function Vr(t){var e=Xr(t);e&&Fr.getActiveElement()!==e&&Nr.focus(e,E.noop,!1,!0)}var Rr=h.utils.browser,Wr=h.eventSandbox.eventSimulator,Hr=h.eventSandbox.listeners,Gr=E.domUtils,zr=E.styleUtils,qr=o.selectElement,jr=($r.prototype.run=function(){this.eventState.clickElement&&Wr.click(this.eventState.clickElement,this.eventArgs.options),Gr.isElementFocusable(this.eventArgs.element)||Vr(this.eventArgs.element)},$r);function $r(t,e){this.eventState=t,this.eventArgs=e}var Zr,Jr=(e(Qr,Zr=jr),Qr.prototype.run=function(){function t(t){n=t.target===e.input}var e=this,n=!1;Hr.addInternalEventListener(Fu,["focus"],t),Zr.prototype.run.call(this),Hr.removeInternalEventListener(Fu,["focus"],t),Gr.isElementFocusable(this.label)&&!n&&this._ensureBoundElementFocusRaised()},Qr.prototype._ensureBoundElementFocusRaised=function(){Wr.focus(this.input)},Qr);function Qr(t,e){var n=Zr.call(this,t,e)||this;return n.label=n.eventArgs.element,n.input=Xr(n.eventArgs.element),n}var ts,es=(e(ns,ts=jr),ns.prototype.run=function(){ts.prototype.run.call(this),this._toggleSelectOptionList()},ns.prototype._toggleSelectOptionList=function(){var t=this.eventArgs.element;1===zr.getSelectElementSize(t)&&!1!==this.eventState.simulateDefaultBehavior&&(qr.isOptionListExpanded(t)?qr.collapseOptionList():qr.expandOptionList(t))},ns);function ns(t,e){return ts.call(this,t,e)||this}var is,os=(e(rs,is=jr),rs.prototype.run=function(){return this.eventArgs.element},rs);function rs(t,e){return is.call(this,t,e)||this}var ss,ls=(e(as,ss=Jr),as.prototype.run=function(){function t(){e=!0}var e=!1;Hr.addInternalEventListener(Fu,["change"],t),ss.prototype.run.call(this),Hr.removeInternalEventListener(Fu,["change"],t),Rr.isChrome&&!e&&this._ensureCheckboxStateChanged()},as.prototype._ensureCheckboxStateChanged=function(){this.checkbox.checked=!this.checkbox.checked,Wr.change(this.checkbox)},as);function as(t,e){var n=ss.call(this,t,e)||this;return n.checkbox=n.input,n}var us,cs=h.Promise,hs=h.utils.extend,fs=h.utils.browser,ds=h.utils.featureDetection,ms=h.eventSandbox.eventSimulator,ps=h.eventSandbox.listeners,vs=E.domUtils,gs=E.eventUtils,Es=E.arrayUtils,ys=E.delay,Ss=(e(bs,us=Ur),bs.prototype._bindMousedownHandler=function(){var e=this,n=function(t){e.eventState.mousedownPrevented=t.defaultPrevented,gs.preventDefault(t),gs.unbind(e.element,"mousedown",n)};gs.bind(this.element,"mousedown",n)},bs.prototype._bindBlurHandler=function(t){var e=this,n=function(){e.eventState.blurRaised=!0,gs.unbind(t,"blur",n,!0)};gs.bind(t,"blur",n,!0)},bs.prototype._raiseTouchEvents=function(t){ds.isTouchDevice&&(ms.touchstart(t.element,t.options),ms.touchend(t.element,t.options))},bs.prototype._mousedown=function(n){var i=this;return this.targetElementParentNodes=vs.getParents(n.element),this.mouseDownElement=n.element,b.leftButtonDown().then(function(){i._raiseTouchEvents(n);var t=vs.getActiveElement();i.activeElementBeforeMouseDown=t;var e=(fs.isWebKit||fs.isIE)&&vs.isSelectElement(i.mouseDownElement);return e&&i._bindMousedownHandler(),i._bindBlurHandler(t),i.eventState.simulateDefaultBehavior=ms.mousedown(n.element,n.options),!1===i.eventState.simulateDefaultBehavior&&(i.eventState.simulateDefaultBehavior=e&&!i.eventState.mousedownPrevented),i._ensureActiveElementBlur(t)}).then(function(){return i._focus(n)})},bs.prototype._ensureActiveElementBlur=function(e){var n=this;return new cs(function(t){vs.getActiveElement()===e||n.eventState.blurRaised?t():fs.isIE&&fs.version<12?Oo().then(function(){n.eventState.blurRaised||ms.blur(e),t()}):(ms.blur(e),t())})},bs.prototype._focus=function(t){return!1===this.eventState.simulateDefaultBehavior?cs.resolve():Kr(vs.isContentEditableElement(this.element)?this.element:t.element,!fs.isIE||this.activeElementBeforeMouseDown===vs.getActiveElement(),this.caretPos)},bs._getElementForClick=function(t,e,n){var i=vs.getParents(e),o=vs.isTheSameNode(e,t);return fs.isFirefox?o?t:null:o?Es.equals(n,i)?t:null:t.contains(e)&&!vs.isEditableFormElement(e)?t:e.contains(t)?e:Es.getCommonElement(i,n)},bs.prototype._mouseup=function(i){var o=this;return b.buttonUp().then(function(){return o._getElementForEvent(i)}).then(function(t){i.element=t,o.eventState.clickElement=bs._getElementForClick(o.mouseDownElement,t,o.targetElementParentNodes);var e={},n=function(t){e=t.timeStamp,ps.removeInternalEventListener(Fu,["mouseup"],n)};return fs.isIE||ps.addInternalEventListener(Fu,["mouseup"],n),ms.mouseup(t,i.options),{timeStamp:e}})},bs.prototype._click=function(t){var e,n,i,o,r,s,l;return e=this.eventState,i=Xr((n=t).element),o=Gr.isSelectElement(n.element),r=Gr.isOptionElement(n.element),s=Gr.isLabelElement(n.element)&&i,l=i&&Gr.isCheckboxElement(i),new(o?es:r?os:l?ls:s?Jr:jr)(e,n).run(),t},bs.prototype.run=function(t){var r=this,s=null;return this._ensureElement(t).then(function(t){var e=t.element,n=t.clientPoint,i=t.screenPoint,o=t.devicePoint;return s={point:n,screenPoint:i,element:e,options:hs({clientX:n.x,clientY:n.y,screenX:o.x,screenY:o.y},r.modifiers)},cs.all([ys(r.automationSettings.mouseActionStepDelay),r._mousedown(s)])}).then(function(){return r._mouseup(s)}).then(function(t){var e=t.timeStamp;return s.options.timeStamp=e,r._click(s)})},bs);function bs(t,e){var n=us.call(this,t,e)||this;return n.modifiers=e.modifiers,n.caretPos=e.caretPos,n.targetElementParentNodes=[],n.activeElementBeforeMouseDown=null,n.mouseDownElement=null,n.eventState={mousedownPrevented:!1,blurRaised:!1,simulateDefaultBehavior:!0,clickElement:null},n}var Ps=h.Promise,xs=h.utils.browser,_s=h.utils.featureDetection,As=h.eventSandbox.eventSimulator,Cs=h.eventSandbox.focusBlur,ws=h.nativeMethods,Ts=E.domUtils,Ms=E.styleUtils,Us=E.delay,Ds=o.selectElement,Is=_s.isTouchDevice?0:160,ks=(Bs.prototype._calculateEventArguments=function(){var t=this.optionListExpanded?Ds.getEmulatedChildElement(this.element):this.element,e=1<Ms.getSelectElementSize(this.parentSelect);return{options:this.modifiers,element:xs.isIE&&e?this.parentSelect:t}},Bs.prototype._getMoveArguments=function(){var t=null,e=null,n=null;if(this.optionListExpanded){var i=v(t=Ds.getEmulatedChildElement(this.element));e=i.offsetX,n=i.offsetY}else{t=Lu.documentElement;var o=Ds.getSelectChildCenter(this.element);e=o.x,n=o.y}return{element:t,offsetX:e,offsetY:n,speed:this.speed}},Bs.prototype._move=function(t){var e=this,n=t.element,i=t.offsetX,o=t.offsetY,r=t.speed,s=new So({offsetX:i,offsetY:o,speed:r,modifiers:this.modifiers},!1);return new Ar(n,s).run().then(function(){return Us(e.automationSettings.mouseActionStepDelay)})},Bs.prototype._mousedown=function(){var t=this;return xs.isFirefox?(As.mousedown(this.eventsArgs.element,this.eventsArgs.options),this.clickCausesChange&&(this.parentSelect.selectedIndex=this.childIndex),this._focus()):xs.isIE?(As.mousedown(this.eventsArgs.element,this.eventsArgs.options),this._focus()):this._focus().then(function(){return Us(Is)}).then(function(){As.mousedown(t.eventsArgs.element,t.eventsArgs.options),t.clickCausesChange&&(t.parentSelect.selectedIndex=t.childIndex)})},Bs.prototype._focus=function(){var e=this;return new Ps(function(t){Cs.focus(e.parentSelect,t,!1,!0)})},Bs.prototype._mouseup=function(){var t=xs.isIE?this.parentSelect:this.eventsArgs.element;As.mouseup(t,this.eventsArgs.options),xs.isIE&&this.clickCausesChange&&(this.parentSelect.selectedIndex=this.childIndex);var e=xs.isFirefox||xs.isSafari||xs.isChrome&&53<=xs.version,n=e||xs.isIE;return e&&this.clickCausesChange&&As.input(this.parentSelect),n&&this.clickCausesChange&&As.change(this.parentSelect),Ps.resolve()},Bs.prototype._click=function(){As.click(this.eventsArgs.element,this.eventsArgs.options)},Bs.prototype.run=function(){var t=this;if(!this.parentSelect)return As.click(this.eventsArgs.element,this.eventsArgs.options),Ps.resolve();this.optionListExpanded||Ds.scrollOptionListByChild(this.element);var e=this._getMoveArguments();return this.eventsArgs=this._calculateEventArguments(),Ms.getSelectElementSize(this.parentSelect)<=1?this._move(e).then(function(){return t._click()}):this._move(e).then(function(){return t._mousedown()}).then(function(){return t._mouseup()}).then(function(){return t._click()})},Bs);function Bs(t,e){if(this.element=t,this.modifiers=e.modifiers,this.caretPos=e.caretPos,this.offsetX=e.offsetX,this.offsetY=e.offsetY,this.speed=e.speed,this.automationSettings=new k(e.speed),this.parentSelect=Ts.getSelectParent(this.element),this.optionListExpanded=!!this.parentSelect&&Ds.isOptionListExpanded(this.parentSelect),this.childIndex=null,this.clickCausesChange=!1,this.parentSelect){var n=Ts.isOptionElement(this.element),i=this.parentSelect.selectedIndex;this.childIndex=Ts.getElementIndexInParent(this.parentSelect,this.element);var o=ws.nodeParentNodeGetter.call(this.element),r=Ts.isOptionGroupElement(o)?o:null,s=this.element.disabled||r&&r.disabled;this.clickCausesChange=n&&!s&&this.childIndex!==i}this.eventsArgs={options:this.modifiers,element:this.element}}var Ns,Os=h.utils.featureDetection,Ys=h.utils.browser,Fs=h.eventSandbox.eventSimulator,Ls=E.eventUtils,Ks=E.delay,Xs=Os.isTouchDevice?0:160,Vs=(e(Rs,Ns=Ur),Rs.prototype._firstClick=function(t){var e=this,n=new go(this.options);n.speed=1;var i=new Ss(this.element,n);return i.on(i.TARGET_ELEMENT_FOUND_EVENT,function(t){return e.emit(e.TARGET_ELEMENT_FOUND_EVENT,t)}),i.run(t).then(function(t){return Ks(Xs).then(function(){return t})})},Rs.prototype._secondClick=function(t){var e=this;Ys.isIE&&Ls.bind(Lu,"focus",Ls.preventDefault,!0);var n=new go({offsetX:t.screenPoint.x,offsetY:t.screenPoint.y,caretPos:this.caretPos,modifiers:this.modifiers,speed:1}),i=new Ss(Lu.documentElement,n);return i.run().then(function(t){return e.eventState.dblClickElement=i.eventState.clickElement,Ys.isIE&&Ls.unbind(Lu,"focus",Ls.preventDefault,!0),t})},Rs.prototype._dblClick=function(t){this.eventState.dblClickElement&&Fs.dblclick(this.eventState.dblClickElement,t.options)},Rs.prototype.run=function(t){var e=this;return this._firstClick(t).then(function(t){return e._secondClick(t)}).then(function(t){return e._dblClick(t)})},Rs);function Rs(t,e){var n=Ns.call(this,t,e)||this;return n.modifiers=e.modifiers,n.caretPos=e.caretPos,n.speed=e.speed,n.automationSettings=new k(n.speed),n.offsetX=e.offsetX,n.offsetY=e.offsetY,n.eventArgs=null,n.eventState={dblClickElement:null},n}var Ws,Hs=h.Promise,Gs=h.utils.extend,zs=h.utils.featureDetection,qs=h.eventSandbox.eventSimulator,js=h.eventSandbox.focusBlur,$s=(e(Zs,Ws=Ur),Zs.prototype._getEndPoint=function(){throw new Error("Not implemented")},Zs.prototype._mousedown=function(t){var e=this;return b.leftButtonDown().then(function(){return e.simulateDefaultBehavior=qs[e.downEvent](t.element,t.options),e._focus(t)})},Zs.prototype._focus=function(n){var i=this;return new Hs(function(t){var e=m.domUtils.isContentEditableElement(i.element)?m.contentEditable.findContentEditableParent(i.element):n.element;js.focus(e,t,!1,!0)})},Zs.prototype._getDestination=function(){throw new Error("Not implemented")},Zs.prototype._drag=function(){var e=this,t=this._getDestination(),n=t.element,i=t.offsets,o=t.endPoint;this.endPoint=o;var r=new So({offsetX:i.offsetX,offsetY:i.offsetY,modifiers:this.modifiers,speed:this.speed,minMovingTime:25,holdLeftButton:!0,skipDefaultDragBehavior:!1===this.simulateDefaultBehavior},!1);return new Ar(n,r).run().then(function(t){return e.dragAndDropState=t,m.delay(e.automationSettings.mouseActionStepDelay)})},Zs.prototype._mouseup=function(){var r=this;return b.buttonUp().then(function(){var n=m.positionUtils.offsetToClientCoords(r.endPoint),i=null,o=Gs({clientX:n.x,clientY:n.y},r.modifiers);return U(n.x,n.y).then(function(t){var e=t.element;return(i=e)?(r.dragAndDropState.enabled?(o.dataTransfer=r.dragAndDropState.dataTransfer,r.dragAndDropState.dropAllowed&&qs.drop(i,o),qs.dragend(r.dragAndDropState.element,o),r.dragAndDropState.dataStore.setProtectedMode()):qs[r.upEvent](i,o),U(n.x,n.y)):i}).then(function(t){var e=t.element;i&&e===i&&!r.dragAndDropState.enabled&&qs.click(i,o)})})},Zs.prototype.run=function(t){var i=this,o=null;return this._ensureElement(t).then(function(t){var e=t.element,n=t.clientPoint;return o={point:n,element:e,options:Gs({clientX:n.x,clientY:n.y},i.modifiers)},Hs.all([m.delay(i.automationSettings.mouseActionStepDelay),i._mousedown(o)])}).then(function(){return i._drag()}).then(function(){return i._mouseup()})},Zs);function Zs(t,e){var n=Ws.call(this,t,e)||this;return n.modifiers=e.modifiers,n.speed=e.speed,n.offsetX=e.offsetX,n.offsetY=e.offsetY,n.endPoint=null,n.simulateDefaultBehavior=!0,n.downEvent=zs.isTouchDevice?"touchstart":"mousedown",n.upEvent=zs.isTouchDevice?"touchend":"mouseup",n.dragAndDropState=null,n}var Js,Qs=E.styleUtils,tl=(e(el,Js=$s),el.prototype._getDestination=function(){var t=s(this.element,this.offsetX,this.offsetY),e=Qs.getWidth(Lu),n=Qs.getHeight(Lu),i={x:t.x+this.dragOffsetX,y:t.y+this.dragOffsetY};return i={x:Math.min(Math.max(0,i.x),e),y:Math.min(Math.max(0,i.y),n)},{element:Lu.documentElement,offsets:{offsetX:i.x,offsetY:i.y},endPoint:i}},el);function el(t,e,n,i){var o=Js.call(this,t,i)||this;return o.dragOffsetX=e,o.dragOffsetY=n,o}var nl,il=E.positionUtils,ol=(e(rl,nl=$s),rl.prototype._getDestination=function(){var t=this.destinationElement,e=il.getElementRectangle(t),n=g(t,this.destinationOffsetX,this.destinationOffsetY);return{element:t,offsets:n,endPoint:{x:e.left+n.offsetX,y:e.top+n.offsetY}}},rl);function rl(t,e,n){var i=nl.call(this,t,n)||this;return i.destinationElement=e,i.destinationOffsetX=n.destinationOffsetX,i.destinationOffsetY=n.destinationOffsetY,i}var sl,ll=(e(al,sl=Ur),al.prototype.run=function(t){return this._ensureElement(t,!0)},al);function al(t,e){return sl.call(this,t,e)||this}var ul=h.utils.browser,cl=h.sandbox.event,hl=h.eventSandbox.eventSimulator,fl=h.eventSandbox.listeners,dl=h.nativeMethods,ml=E.domUtils,pl=E.contentEditable,vl=E.textSelection,gl=/ /g;function El(t){var e=vl.getSelectionByElement(t),n=vl.hasInverseSelectionContentEditable(t);return vl.hasElementContainsSelection(t)?pl.getSelection(t,e,n):{startPos:pl.calculateNodeAndOffsetByPosition(t,0),endPos:pl.calculateNodeAndOffsetByPosition(t,0)}}function yl(t){var e=t.startPos.node,n=t.startPos.offset,i=t.endPos.offset,o=pl.getFirstNonWhitespaceSymbolIndex(e.nodeValue),r=pl.getLastNonWhitespaceSymbolIndex(e.nodeValue);return n<o&&0!==n?(t.startPos.offset=o,t.endPos.offset=i+o-n):r<i&&i!==e.nodeValue.length&&(t.startPos.offset=e.nodeValue.length,t.endPos.offset=i+e.nodeValue.length-n),t}function Sl(t,e,n){return!n||hl.beforeInput(t,e)}function bl(t,e){var n;function i(t){t.preventDefault(),n=!0}function o(t){"textInput"===t.type&&(n=!1)}ul.isSafari&&(fl.addInternalEventListener(Fu,["textInput"],i),cl.on(cl.EVENT_PREVENTED_EVENT,o));var r=ul.isFirefox||hl.textInput(t,e)||n;return ul.isSafari&&(fl.removeInternalEventListener(Fu,["textInput"],i),cl.off(cl.EVENT_PREVENTED_EVENT,o)),r||ul.isIE11}function Pl(t,e){var n,i,o,r,s,l,a,u,c,h,f=El(t),d=f.startPos.node,m=f.endPos.node,p=!0,v=!0,g=e;function E(){v=!1}function y(t,e,n){n()}e=e.replace(gl,String.fromCharCode(160)),d&&m&&ml.isContentEditableElement(d)&&ml.isContentEditableElement(m)&&(ml.isTheSameNode(d,m)||(vl.deleteSelectionContents(t),n=t,o=(i=f).startPos.node,r=dl.nodeParentNodeGetter.call(o)&&o.parentElement,!(ul.isChrome&&ul.version<58||ul.isSafari)&&r&&ml.isElementContainsNode(n,o)||(i=El(n),vl.hasInverseSelectionContentEditable(n)&&(i={startPos:i.endPos,endPos:i.startPos})),i.endPos.offset=i.startPos.offset,d=(f=i).startPos.node),d&&ml.isContentEditableElement(d)&&ml.isRenderedNode(d)&&Sl(t,e,ul.isChrome)&&(p=bl(t,g),v=p&&!ul.isIE11,fl.addInternalEventListener(Fu,["input"],E),fl.addInternalEventListener(Fu,["textinput"],y),(p=p&&Sl(t,e,ul.isSafari))&&(ml.isElementNode(d)?(s=d,l=e,u=Lu.createTextNode(l),c={node:u,offset:l.length},h=dl.nodeParentNodeGetter.call(s),"br"===ml.getTagName(s)?h.insertBefore(u,s):0<a?s.insertBefore(u,s.childNodes[a]):s.appendChild(u),vl.selectByNodesAndOffsets(c,c)):function(t,e,n){var i=e.startPos.node;ml.isElementContainsNode(t,i)||(i=(e=yl(El(t))).startPos.node);var o=e.startPos.offset,r=e.endPos.offset,s=i.nodeValue,l={node:i,offset:o+n.length};i.nodeValue=s.substring(0,o)+n+s.substring(r,s.length),vl.selectByNodesAndOffsets(l,l)}(t,yl(f),e)),Oo().then(function(){v&&hl.input(t),fl.removeInternalEventListener(Fu,["input"],E),fl.removeInternalEventListener(Fu,["textinput"],y)})))}function xl(t,e,n){ml.isContentEditableElement(t)&&Pl(t,e),ml.isElementReadOnly(t)||(ml.isTextEditableElement(t)?function(t,e){var n=ml.getElementValue(t),i=e.length,o=vl.getSelectionStart(t),r=vl.getSelectionEnd(t),s=ml.isInputElement(t)&&"number"===t.type;if(Sl(t,e,ul.isChrome)){var l=bl(t,e);if(l=l&&Sl(t,e,ul.isSafari)){var a=!ul.isIE&&s?null:parseInt(t.maxLength,10);a<0&&(a=ul.isIE&&ul.version<17?0:null),(null===a||isNaN(a)||a>n.length)&&(s&&ul.isIOS&&"."===n[n.length-1]&&(o+=1,r+=1),ml.setElementValue(t,n.substring(0,o)+e+n.substring(r,n.length)),vl.select(t,o+i,o+i)),hl.input(t)}}}(t,e):ml.isInputElement(t)&&function(t,e,n){if(null!==n){var i=ml.getElementValue(t);ml.setElementValue(t,i.substr(0,n)+e+i.substr(n+e.length))}else ml.setElementValue(t,e);hl.change(t),hl.input(t)}(t,e,n))}function _l(t){return 1===t.length&&("a"<=t&&t<="z"||"A"<=t&&t<="Z")}var Al=h.nativeMethods,Cl=h.utils.browser,wl=h.eventSandbox.focusBlur,Tl=h.Promise,Ml=m.domUtils.findDocument,Ul=m.domUtils.isRadioButtonElement,Dl=m.domUtils.getActiveElement;function Il(t){return t===t.toLowerCase()?t.toUpperCase():t.toLowerCase()}function kl(t){var e=Dl(t||Lu),n=null;if(e&&m.domUtils.isIframeElement(e)&&Al.contentDocumentGetter.call(e))try{n=kl(Al.contentDocumentGetter.call(e))}catch(t){}return n||e}function Bl(t,e,n){if(!Ul(e))return t;if(!n&&!e.name&&!Cl.isChrome)return[e];var i,o,r=(i=e,o=null,n?""===i.name||Cl.isFirefox||(o=function(t){return!t.name||t===i||t.name!==i.name}):""!==i.name?o=function(t){return Ul(t)&&t.name===i.name}:Cl.isChrome&&(o=function(t){return Ul(t)&&!t.name}),o);return r&&(t=m.arrayUtils.filter(t,r)),t}function Nl(t,e,n){var i=e?-1:1,o=m.domUtils.getFocusableElements(Ml(t),!0);o=Bl(o,t,n);var r,s,l,a,u,c=Ul(t),h=m.arrayUtils.indexOf(o,t);return(e?0===h:h===o.length-1)?n||!c?Lu.body:o[o.length-1-h]:e&&-1===h?o[o.length-1]:(s=(r=o)[h+i],l=n,a=Ul(s)&&s.name&&!s.checked,u=null,l&&a&&(u=m.arrayUtils.find(r,function(t){return Ul(t)&&t.name===s.name&&t.checked})),u||s)}function Ol(t){if(_l(t))return t.toUpperCase().charCodeAt(0);var e=m.KEY_MAPS.shiftMap[t]?m.KEY_MAPS.shiftMap[t].charCodeAt(0):t.charCodeAt(0);return m.KEY_MAPS.symbolCharCodeToKeyCode[e]||e}var Yl={SPECIAL_KEYS:{capslock:"CapsLock",delete:"U+007F",end:"End",enter:"Enter",esc:"U+001B",home:"Home",ins:"Insert",pagedown:"PageDown",pageup:"PageUp",space:"U+0020",tab:"Tab",alt:"Alt",ctrl:"Control",meta:"Meta",shift:"Shift"},LETTERS:{a:"U+0041",b:"U+0042",c:"U+0043",d:"U+0044",e:"U+0045",f:"U+0046",g:"U+0047",h:"U+0048",i:"U+0049",j:"U+004A",k:"U+004B",l:"U+004C",m:"U+004D",n:"U+004E",o:"U+004F",p:"U+0050",q:"U+0051",r:"U+0052",s:"U+0053",t:"U+0054",u:"U+0055",v:"U+0056",w:"U+0057",x:"U+0058",y:"U+0059",z:"U+005A"},SYMBOLS:{0:"U+0030",1:"U+0031",2:"U+0032",3:"U+0033",4:"U+0034",5:"U+0035",6:"U+0036",7:"U+0037",8:"U+0038",9:"U+0039"," ":"U+0020","!":"U+0021","@":"U+0040","#":"U+0023",$:"U+0024","%":"U+0025","^":"U+005E","*":"U+002A","(":"U+0028",")":"U+0029",_:"U+005F","|":"U+007C","\\":"U+005C","/":"U+002F","?":"U+003F",".":"U+002E",",":"U+002C","<":"U+003C",">":"U+003E","[":"U+005B","]":"U+005D","{":"U+007B","}":"U+007D","§":"U+00A7","±":"U+00B1","'":"U+0027",'"':"U+0022",":":"U+003A",";":"U+003B","`":"U+0060","~":"U+007E"}};function Fl(t){return _l(t)?Yl.LETTERS[t.toLowerCase()]:Yl.SYMBOLS[t]||Yl.SPECIAL_KEYS[t]||t}function Ll(t,e,n){var i={};return"keyIdentifier"in KeyboardEvent.prototype&&(i.keyIdentifier=t?"":n),"key"in KeyboardEvent.prototype&&(i.key=e),i}var Kl=h.utils.browser,Xl=h.utils.extend,Vl=h.eventSandbox.eventSimulator,Rl=(Wl._isKeyActivatedInputElement=function(t){return m.domUtils.isInputElement(t)&&/button|submit|reset|radio|checkbox/.test(t.type)},Wl.prototype._type=function(t,e){var n=t!==this.storedActiveElement,i=!n,o=t,r=m.domUtils.isEditableElement(t),s=m.domUtils.isEditableElement(this.storedActiveElement);try{if(n){var l=m.domUtils.isElementInIframe(t)===m.domUtils.isElementInIframe(this.storedActiveElement)||s;i=(!Kl.isFirefox||s)&&(!Kl.isWebKit||l)}}catch(t){}i&&(!Kl.isIE&&n&&s&&r&&(o=this.storedActiveElement),xl(o,e))},Wl.prototype._addKeyPropertyToEventOptions=function(t){return Xl(t,Ll("keypress"===t.type,this.keyProperty,this.keyIdentifierProperty)),t},Wl.prototype.down=function(t){this.storedActiveElement=kl(this.topSameDomainDocument),this.modifierKeyCode&&(t[this.sanitizedKey]=!0),t.shift&&this.isLetter&&(this.keyProperty=Il(this.keyProperty));var e={keyCode:this.keyCode,type:"keydown"};return this._addKeyPropertyToEventOptions(e),Vl.keydown(this.storedActiveElement,Xl(e,t))},Wl.prototype.press=function(t){if(!this.isChar&&!this.specialKeyCode)return!0;var e=kl(this.topSameDomainDocument),n=this.isChar?function(t,e){if("space"===t)return" ";if(e){if(_l(t))return Il(t);if(m.KEY_MAPS.reversedShiftMap[t])return m.KEY_MAPS.reversedShiftMap[t]}return t}(this.sanitizedKey,t.shift):null,i=this.specialKeyCode||n.charCodeAt(0),o=e!==this.storedActiveElement;if(Kl.isWebKit&&o&&m.domUtils.isElementInIframe(e)!==m.domUtils.isElementInIframe(this.storedActiveElement))return!0;this.storedActiveElement=e;var r={keyCode:i,charCode:i,type:"keypress"};this._addKeyPropertyToEventOptions(r);var s=Kl.isAndroid||Vl.keypress(e,Xl(r,t));if(!s)return s;e=kl(this.topSameDomainDocument),!n||t.ctrl||t.alt||this._type(e,n);var l=Wl._isKeyActivatedInputElement(e),a=m.domUtils.isButtonElement(e),u=Kl.isSafari&&0<=Kl.compareVersions([Kl.webkitVersion,"603.1.30"]);return Kl.isFirefox||u||!l&&!a||"enter"!==this.sanitizedKey||e.click(),s},Wl.prototype.up=function(t){this.modifierKeyCode&&(t[this.sanitizedKey]=!1);var e={keyCode:this.keyCode,type:"keyup"};this._addKeyPropertyToEventOptions(e);var n=Vl.keyup(kl(this.topSameDomainDocument),Xl(e,t)),i=kl(this.topSameDomainDocument);return!Kl.isFirefox&&!Kl.isSafari&&(!Kl.isChrome||53<=Kl.version)&&n&&"space"===this.sanitizedKey&&Wl._isKeyActivatedInputElement(i)&&i.click(),n},Object.defineProperty(Wl.prototype,"key",{get:function(){return this.sanitizedKey},enumerable:!0,configurable:!0}),Wl);function Wl(t,e){this.isLetter=_l(t),this.isChar=1===t.length||"space"===t,this.sanitizedKey=m.getSanitizedKey(t),this.modifierKeyCode=m.KEY_MAPS.modifiers[this.sanitizedKey],this.specialKeyCode=m.KEY_MAPS.specialKeys[this.sanitizedKey],this.keyCode=null,this.keyIdentifierProperty=Fl(e),this.topSameDomainDocument=m.domUtils.getTopSameDomainWindow(Fu).document,this.keyProperty=m.KEY_MAPS.keyProperty[e]||e,this.isChar&&"space"!==t?this.keyCode=Ol(this.sanitizedKey):this.modifierKeyCode?this.keyCode=this.modifierKeyCode:this.specialKeyCode&&(this.keyCode=this.specialKeyCode),this.storedActiveElement=null}var Hl=h.Promise,Gl=h.utils.browser,zl=h.eventSandbox.eventSimulator,ql=h.eventSandbox.elementEditingWatcher,jl=E.textSelection,$l=E.eventUtils,Zl=E.domUtils,Jl=o.selectElement,Ql=null,ta=null;function ea(){ta=Ql=null,$l.unbind(this,"blur",ea,!0)}function na(t){var e,n,i,o;Zl.isTextAreaElement(t)&&(Ql!==t&&($l.bind(t,"blur",ea,!0),Ql=t),e=t,n=jl.hasInverseSelection(e),i=Zl.getTextAreaValue(e),o=n?jl.getSelectionStart(e):jl.getSelectionEnd(e),ta=i&&o?Zl.getTextareaIndentInLine(e,o):0)}function ia(t,e){var n=Zl.getTextAreaValue(t);if(n){var i=jl.getSelectionStart(t),o=jl.getSelectionEnd(t),r=jl.hasInverseSelection(t),s=n.substring(0,r?i:o),l=s.lastIndexOf("\n"),a=s.substring(0,l);null!==ta&&Ql===t||na(t),l=a.lastIndexOf("\n"),ra(t,i,o,r,Math.min(l+1+ta,a.length),e)}}function oa(t,e){var n=Zl.getTextAreaValue(t);if(n){var i=jl.getSelectionStart(t),o=jl.getSelectionEnd(t),r=jl.hasInverseSelection(t),s=r?i:o,l=n.substring(s),a=l.indexOf("\n"),u=-1===a?l.length:a+1,c=l.substring(u),h=s+u,f=-1===(a=c.indexOf("\n"))?c.length:a;null!==ta&&Ql===t||na(t),ra(t,i,o,r,h=Math.min(h+ta,h+f),e)}}function ra(t,e,n,i,o,r){var s=null,l=null;l=r?(s=e!==n&&i?n:e,o):s=o,jl.select(t,s,l)}function sa(t,e,n){Zl.isInputElement(t)&&"number"===t.type&&("-"===e.charAt(0)&&"."===e.charAt(1)&&(e=e.substring(1)),"."===e.charAt(e.length-1)&&(e=e.substring(0,e.length-1))),Zl.setElementValue(t,e),jl.select(t,n,n),zl.input(t)}function la(t,e){if(Zl.isTextEditableElement(t)){var n=jl.getSelectionStart(t),i=jl.getSelectionEnd(t),o=jl.hasInverseSelection(t),r=null,s=!Zl.isTextAreaElement(t)||Zl.getTextareaLineNumberByPosition(t,n)===Zl.getTextareaLineNumberByPosition(t,i);r=s?o?i:n:o?n:i;var l=Zl.getElementValue(t).substring(0,r).lastIndexOf("\n"),a=-1===l?0:l+1,u=null;s?(u=e?r:a,jl.select(t,u,a)):o?jl.select(t,i,a):jl.select(t,n,a)}return Hl.resolve()}function aa(t,e){if(Zl.isTextEditableElement(t)){var n=jl.getSelectionStart(t),i=jl.getSelectionEnd(t),o=jl.hasInverseSelection(t),r=null,s=!Zl.isTextAreaElement(t)||Zl.getTextareaLineNumberByPosition(t,n)===Zl.getTextareaLineNumberByPosition(t,i);r=s?o?i:n:o?n:i;var l=Zl.getElementValue(t).substring(r),a=l.indexOf("\n"),u=r,c=null;u+=-1===a?l.length:a,s?(c=e?r:u,jl.select(t,c,u)):o?jl.select(t,i,u):jl.select(t,n,u)}return Hl.resolve()}function ua(t){return la(t,!0)}function ca(t){return aa(t,!0)}function ha(t){return Zl.isRadioButtonElement(t)&&!Gl.isFirefox}function fa(t,e){return da(t,e,!1).then(function(t){t&&(t.checked=!0)})}function da(t,e,n){return void 0===n&&(n=!0),t?(Zl.isSelectElement(t)&&Jl.collapseOptionList(),i=t,o=e,r=n,new Tl(function(t){var e=Nl(i,o,r);e?wl.focus(e,function(){return t(e)}):t()}).then(function(t){return t&&Zl.isTextEditableInput(t)&&jl.select(t),t})):Hl.resolve();var i,o,r}var ma={"ctrl+a":function(t){return Zl.isEditableElement(t)&&jl.select(t),Hl.resolve()},backspace:function(t){if(Zl.isTextEditableElementAndEditingAllowed(t)){var e=jl.getSelectionStart(t),n=jl.getSelectionEnd(t),i=Zl.getElementValue(t).replace(/\r\n/g,"\n");n===e?0<e&&sa(t,i.substring(0,e-1)+i.substring(n,i.length),e-1):sa(t,i.substring(0,e)+i.substring(n,i.length),e)}return Zl.isContentEditableElement(t)&&jl.deleteSelectionContents(t),Hl.resolve()},delete:function(t){if(Zl.isTextEditableElementAndEditingAllowed(t)){var e=jl.getSelectionStart(t),n=jl.getSelectionEnd(t),i=Zl.getElementValue(t).replace(/\r\n/g,"\n");n===e?e<i.length&&sa(t,i.substring(0,e)+i.substring(n+1,i.length),e):sa(t,i.substring(0,e)+i.substring(n,i.length),e)}return Zl.isContentEditableElement(t)&&jl.deleteSelectionContents(t),Hl.resolve()},left:function(t){var e=null;if(Zl.isSelectElement(t)&&Jl.switchOptionsByKeys(t,"left"),ha(t))return fa(t,!0);if(Zl.isTextEditableElement(t)){var n=(e=jl.getSelectionStart(t)||0)===jl.getSelectionEnd(t)?e-1:e;jl.select(t,n,n),na(t)}if(Zl.isContentEditableElement(t)&&(e=jl.getSelectionStart(t))!==jl.getSelectionEnd(t)){var i=jl.getSelectionByElement(t),o=jl.hasInverseSelectionContentEditable(t),r={node:o?i.focusNode:i.anchorNode,offset:o?i.focusOffset:i.anchorOffset};jl.selectByNodesAndOffsets(r,r,!0)}return Hl.resolve()},right:function(t){var e=null,n=null;if(Zl.isSelectElement(t)&&Jl.switchOptionsByKeys(t,"right"),ha(t))return fa(t,!1);if(Zl.isTextEditableElement(t)){var i=(e=jl.getSelectionStart(t))===(n=jl.getSelectionEnd(t))?n+1:n;e===Zl.getElementValue(t).length&&(i=e),jl.select(t,i,i),na(t)}if(Zl.isContentEditableElement(t)&&(e=jl.getSelectionStart(t))!==(n=jl.getSelectionEnd(t))){var o=jl.getSelectionByElement(t),r=jl.hasInverseSelectionContentEditable(t),s={node:r?o.anchorNode:o.focusNode,offset:r?o.anchorOffset:o.focusOffset};jl.selectByNodesAndOffsets(s,s,!0)}return Hl.resolve()},up:function(t){return Zl.isSelectElement(t)&&Jl.switchOptionsByKeys(t,"up"),ha(t)?fa(t,!0):Gl.isWebKit&&Zl.isInputElement(t)?la(t):(Zl.isTextAreaElement(t)&&ia(t,!1),Hl.resolve())},down:function(t){return Zl.isSelectElement(t)&&Jl.switchOptionsByKeys(t,"down"),ha(t)?fa(t,!1):Gl.isWebKit&&Zl.isInputElement(t)?aa(t):(Zl.isTextAreaElement(t)&&oa(t,!1),Hl.resolve())},"shift+left":function(t){if(Zl.isTextEditableElement(t)){var e=jl.getSelectionStart(t),n=jl.getSelectionEnd(t);e===n||jl.hasInverseSelection(t)?jl.select(t,n,Math.max(e-1,0)):jl.select(t,e,Math.max(n-1,0)),na(t)}return Hl.resolve()},"shift+right":function(t){if(Zl.isTextEditableElement(t)){var e=jl.getSelectionStart(t),n=jl.getSelectionEnd(t),i=Zl.getElementValue(t).length;e!==n&&jl.hasInverseSelection(t)?jl.select(t,n,Math.min(e+1,i)):jl.select(t,e,Math.min(n+1,i)),na(t)}return Hl.resolve()},"shift+up":function(t){return Gl.isWebKit&&Zl.isInputElement(t)?ua(t):(Zl.isTextAreaElement(t)&&ia(t,!0),Hl.resolve())},"shift+down":function(t){return Gl.isWebKit&&Zl.isInputElement(t)?ca(t):(Zl.isTextAreaElement(t)&&oa(t,!0),Hl.resolve())},"shift+home":ua,"shift+end":ca,home:la,end:aa,enter:function(t){if(Zl.isSelectElement(t)&&Jl.collapseOptionList(),Zl.isInputElement(t)){Gl.isIE||ql.processElementChanging(t);var e=Zl.getParents(t,"form")[0];e&&function(t,e){var n=t.querySelectorAll("input, button"),i=null,o=null;for(o=0;o<n.length;o++)if(!i&&"submit"===n[o].type&&!n[o].disabled){i=n[o];break}if(i)zl.click(i);else if(Zl.blocksImplicitSubmission(e)){var r=t.getElementsByTagName("input"),s=[];for(o=0;o<r.length;o++)Zl.blocksImplicitSubmission(r[o])&&s.push(r[o]);1===s.length&&s[0]===e&&e.validity.valid&&zl.submit(t)&&t.submit()}}(e,t)}else if(Zl.isTextAreaElement(t)){var n=jl.getSelectionStart(t),i=Zl.getTextAreaValue(t),o=i.substring(0,n),r=i.substring(n),s=n+1;sa(t,o+String.fromCharCode(10)+r,s)}else t.tagName&&Zl.isAnchorElement(t)&&zl.click(t);return Hl.resolve()},tab:function(t){return da(t,!1)},"shift+tab":function(t){return da(t,!0)},esc:function(t){return Zl.isSelectElement(t)&&Jl.collapseOptionList(),Hl.resolve()}},pa=h.Promise,va=h.utils.browser,ga=h.eventSandbox.message,Ea=h.nativeMethods,ya="automation|press|request",Sa="automation|press|response";ga.on(ga.SERVICE_MSG_RECEIVED_EVENT,function(t){t.message.cmd===ya&&(h.on(h.EVENTS.beforeUnload,function(){return ga.sendServiceMsg({cmd:Sa},t.source)}),new ba(t.message.keyCombinations,t.message.options).run().then(function(){return ga.sendServiceMsg({cmd:Sa},t.source)}))});var ba=(Pa._getKeyPressSimulators=function(t){var e=function(t){for(var e=t.slice(),n=0;n<t.length;n++){var i=t[n];if("shift"===i.toLowerCase()){var o=t[n+1];if(!o)continue;m.KEY_MAPS.shiftMap[o]?t[n+1]=m.KEY_MAPS.shiftMap[o]:m.KEY_MAPS.reversedShiftMap[o]&&(e[n+1]=m.KEY_MAPS.reversedShiftMap[o])}!m.KEY_MAPS.shiftMap[i]||t[n-1]&&"shift"===t[n-1].toLowerCase()||(t[n]=m.KEY_MAPS.shiftMap[i],t.splice(n,0,"shift"),e.splice(n,0,"shift"),n++)}return{actualKeys:t,eventKeyProperties:e}}(m.getKeyArray(t)),n=e.actualKeys,i=e.eventKeyProperties;return m.arrayUtils.map(n,function(t,e){return new Rl(t,i[e])})},Pa._getShortcuts=function(t){for(var e=m.getKeyArray(t.toLowerCase()),n=[],i=[],o=[],r=0;r<e.length;r++)for(i.push(e[r]),o=i.slice();o.length;){var s=o.join("+");ma[s]?(n.push(s),i=o=[]):o.shift()}return n},Pa._getShortcutHandlers=function(t){for(var e=Pa._getShortcuts(t.toLowerCase()),n={},i="",o=null,r=null,s=null,l=0;l<e.length;l++)o=e[l],r=t.indexOf(o),s=o.length,n[i+=t.substring(0,r+s)]=ma[o],t=t.substring(r+s);return n},Pa.prototype._down=function(t){this.pressedKeyString+=(this.pressedKeyString?"+":"")+t.key;var e=!t.down(this.modifiersState);return pa.resolve(e)},Pa.prototype._press=function(t,e){var n=this;if(e&&!this.isSelectElement)return m.delay(this.automationSettings.keyActionStepDelay);var i=this.shortcutHandlers[this.pressedKeyString],o=!1;return i&&!va.isFirefox&&"enter"!==t.key||(o=!t.press(this.modifiersState)),o&&!this.isSelectElement||!i?m.delay(this.automationSettings.keyActionStepDelay):i(kl(this.topSameDomainDocument)).then(function(){return m.delay(n.automationSettings.keyActionStepDelay)})},Pa.prototype._up=function(t){return t.up(this.modifiersState),m.delay(this.automationSettings.keyActionStepDelay)},Pa.prototype._runCombination=function(t){var n=this;this.modifiersState={ctrl:!1,alt:!1,shift:!1,meta:!1},this.isSelectElement=m.domUtils.isSelectElement(kl(this.topSameDomainDocument)),this.pressedKeyString="",this.shortcutHandlers=Pa._getShortcutHandlers(t);var e=Pa._getKeyPressSimulators(t);return m.promiseUtils.each(e,function(e){return n._down(e).then(function(t){return n._press(e,t)})}).then(function(){return m.arrayUtils.reverse(e),m.promiseUtils.each(e,function(t){return n._up(t)})})},Pa.prototype.run=function(){var e=this,t=m.domUtils.getActiveElement(),n=m.domUtils.isIframeElement(t);if(Fu.top===Fu&&n&&Ea.contentWindowGetter.call(t)){var i={cmd:ya,keyCombinations:this.keyCombinations,options:this.options};return m.sendRequestToFrame(i,Sa,Ea.contentWindowGetter.call(t))}return m.promiseUtils.each(this.keyCombinations,function(t){return e._runCombination(t).then(function(){return m.delay(e.automationSettings.keyActionStepDelay)})})},Pa);function Pa(t,e){this.keyCombinations=t,this.isSelectElement=!1,this.pressedKeyString="",this.modifiersState=null,this.shortcutHandlers=null,this.topSameDomainDocument=m.domUtils.getTopSameDomainWindow(Fu).document,this.automationSettings=new k(e.speed),this.options=e}var xa,_a=h.Promise,Aa=h.utils.extend,Ca=h.utils.browser,wa=h.eventSandbox.eventSimulator,Ta=E.domUtils,Ma=E.eventUtils,Ua=E.delay,Da=(e(Ia,xa=Ur),Ia.prototype._mousedown=function(t){var e=this;return b.rightButtonDown().then(function(){e.eventState.activeElementBeforeMouseDown=Ta.getActiveElement(),e.eventState.simulateDefaultBehavior=wa.mousedown(t.element,t.options)}).then(function(){return e._focus(t)})},Ia.prototype._focus=function(t){return!1===this.simulateDefaultBehavior?Oo():Kr(Ta.isContentEditableElement(this.element)?this.element:t.element,!Ca.isIE||this.eventState.activeElementBeforeMouseDown===Ta.getActiveElement(),this.caretPos).then(function(){return Oo()})},Ia.prototype._mouseup=function(e){var t=this;return b.buttonUp().then(function(){return t._getElementForEvent(e)}).then(function(t){return wa.mouseup(t,e.options)})},Ia.prototype._contextmenu=function(e){return this._getElementForEvent(e).then(function(t){wa.contextmenu(t,e.options),Ta.isElementFocusable(t)||Vr(t)})},Ia.prototype.run=function(t){var o=this,r=null;return this._ensureElement(t).then(function(t){var e=t.element,n=t.clientPoint,i=t.devicePoint;return r={point:n,element:e,options:Aa({clientX:n.x,clientY:n.y,screenX:i.x,screenY:i.y,button:Ma.BUTTON.right},o.modifiers)},_a.all([Ua(o.automationSettings.mouseActionStepDelay),o._mousedown(r)])}).then(function(){return o._mouseup(r)}).then(function(){return o._contextmenu(r)})},Ia);function Ia(t,e){var n=xa.call(this,t,e)||this;return n.modifiers=e.modifiers,n.caretPos=e.caretPos,n.eventState={simulateDefaultBehavior:!0,activeElementBeforeMouseDown:null},n}var ka=h.utils.browser,Ba=E.domUtils,Na=E.positionUtils,Oa=E.styleUtils,Ya=E.contentEditable,Fa=E.arrayUtils,La=["direction","font-family","font-size","font-size-adjust","font-variant","font-weight","font-style","letter-spacing","line-height","text-align","text-indent","text-transform","word-wrap","word-spacing","padding-top","padding-left","padding-right","padding-bottom","margin-top","margin-left","margin-right","margin-bottom","border-top-width","border-left-width","border-right-width","border-bottom-width"];function Ka(t,e){var n=Oa.getBordersWidth(t),i=Na.getOffsetPosition(t),o=t.scrollHeight||t.getBoundingClientRect().height,r=Math.ceil(e.left),s=Math.ceil(e.top),l=Math.floor(e.bottom);if(!Ba.isTextAreaElement(t)){var a=Na.offsetToClientCoords({x:i.left,y:i.top}),u=a.x+n.left+1,c=a.y+n.top+1,h=a.y+n.top+n.bottom+o,f=a.y+n.top+o-1;r=Math.ceil(r<=a.x?u:e.left),s=Math.ceil(s<=a.y?c:e.top),l=Math.floor(h<=l?f:e.bottom)}return{left:r,top:s,bottom:l}}function Xa(t){var e=Oa.getElementScroll(Lu);return{left:t.left+e.left,top:t.top+e.top,bottom:t.bottom+e.top}}function Va(t,e){var n=t.getBoundingClientRect(),i=function(e){var t=Lu.body,n=Na.getOffsetPosition(e),i=Oa.getElementMargin(e),o=n.top-i.top,r=n.left-i.left,s=Lu.createElement("div"),l="white-space:pre-wrap;border-style:solid;";if("absolute"===Oa.get(t,"position")){var a=Oa.getElementMargin(t),u=Oa.get(t,"left"),c=Oa.get(t,"top");r-=a.left+(parseInt(u.replace("px",""),10)||0),o-=a.top+(parseInt(c.replace("px",""),10)||0)}return Fa.forEach(La,function(t){l+=t+":"+Oa.get(e,t)+";"}),Oa.set(s,{cssText:l,position:"absolute",left:r+"px",top:o+"px",width:e.scrollWidth+"px",height:e.scrollHeight+"px"}),h.nativeMethods.nodeTextContentSetter.call(s,Ba.getElementValue(e)+" "),t.appendChild(s),s}(t),o=null,r=t.getBoundingClientRect(),s=r.top-n.top,l=r.left-n.left,a=Ba.getElementValue(t).length;try{var u=Lu.createRange();u.setStart(h.nativeMethods.nodeFirstChildGetter.call(i),Math.min(e,a)),u.setEnd(h.nativeMethods.nodeFirstChildGetter.call(i),Math.min(e+1,a+1)),Ba.isTextAreaElement(t)&&(0!==(o=u.getBoundingClientRect()).width||0!==o.height)||(o=u.getClientRects()[0])}catch(t){o=null}return Ba.remove(i),o?{width:o.width,height:o.height,top:o.top-s,bottom:o.bottom-s,left:o.left-l,right:o.right-l}:null}function Ra(t,e){var n,i,o,r,s,l,a=null;return(a=Ba.isContentEditableElement(t)?(o=t,r=e,s=Ba.findDocument(o).createRange(),l=Ya.calculateNodeAndOffsetByPosition(o,r),s.setStart(l.node,Math.min(l.offset,l.node.length)),s.setEnd(l.node,Math.min(l.offset,l.node.length)),s.getClientRects()[0]):"function"==typeof t.createTextRange?(n=e,(i=t.createTextRange()).collapse(!0),i.moveStart("character",n),i.moveEnd("character",n),i.collapse(!0),i.getBoundingClientRect()):Va(t,e))?{x:(a=Xa(a=Ka(t,a))).left,y:Math.floor(a.top+(a.bottom-a.top)/2)}:null}function Wa(t,e){var n=Ba.isTextEditableElement(t),i=Ba.isContentEditableElement(t);return n&&0<Ba.getElementValue(t).length||i&&Ya.getContentEditableValue(t).length?Ra(t,e):Na.findCenter(t)}function Ha(t,e,n){var i=Ba.findDocument(t).createRange();i.setStart(e,Math.min(n,e.length)),i.setEnd(e,Math.min(n,e.length));var o=i.getClientRects()[0];return o?{x:(o=Xa(o=Ka(t,o))).left,y:Math.floor(o.top+(o.bottom-o.top)/2)}:null}var Ga,za=h.Promise,qa=h.utils.browser,ja=h.utils.featureDetection,$a=h.eventSandbox.eventSimulator,Za=h.eventSandbox.focusBlur,Ja=E.contentEditable,Qa=E.domUtils,tu=E.positionUtils,eu=E.eventUtils,nu=E.delay,iu=(e(ou,Ga=Ur),ou._calculateEventArguments=function(t){var n=tu.offsetToClientCoords(t);return U(n.x,n.y).then(function(t){var e=t.element;if(!e)throw new Error(I.elementIsInvisibleError);return{element:e,options:{clientX:n.x,clientY:n.y}}})},ou.prototype._move=function(t){var e=this,n=t.element,i=t.offsetX,o=t.offsetY,r=t.speed,s=new So({offsetX:i,offsetY:o,speed:r},!1);return new Ar(n,s).run().then(function(){return nu(e.automationSettings.mouseActionStepDelay)})},ou.prototype._bindMousedownHandler=function(){var e=this,n=function(t){e.eventState.mousedownPrevented=t.defaultPrevented,eu.preventDefault(t),eu.unbind(e.element,"mousedown",n)};eu.bind(this.element,"mousedown",n)},ou.prototype._calculateAbsoluteStartPoint=function(){throw new Error("Not implemented")},ou.prototype._calculateAbsoluteEndPoint=function(){throw new Error("Not implemented")},ou.prototype._moveToPoint=function(t){!function(t,e){if(Ba.isEditableElement(t)){var n=Ba.isTextAreaElement(t);if(!Ba.isInputElement(t)||!(ka.isFirefox||ka.isIE&&10<ka.version)){var i=Na.getOffsetPosition(t),o=Oa.getBordersWidth(t),r=Oa.getElementScroll(t),s=e.x-i.left-o.left,l=e.y-i.top-o.top,a=null;if(n)return l<r.top&&(a=l),l>t.clientHeight+r.top&&(a=l-t.clientHeight),null!==a&&Oa.setScrollTop(t,Math.round(a));s<r.left&&(a=s),s>t.clientWidth+r.left&&(a=s-t.clientWidth),null!==a&&Oa.setScrollLeft(t,Math.round(a))}}}(this.element,t),this.clientPoint=function(t,e){var n=Ba.isTextEditableElement(t),i=Ba.isInputElement(t);if(!n&&!Ba.isContentEditableElement(t))return e;var o=Na.getOffsetPosition(t),r=Oa.getBordersWidth(t),s=Oa.getElementScroll(t),l=o.left+r.left+t.clientWidth;return i&&n&&(ka.isFirefox||ka.isIE&&10<ka.version)?{x:Math.min(e.x,l),y:e.y}:{x:e.x-s.left,y:e.y-s.top}}(this.element,t);var e={element:Lu.documentElement,offsetX:this.clientPoint.x,offsetY:this.clientPoint.y,speed:this.speed};return this._move(e)},ou.prototype._mousedown=function(){var n=this;return b.leftButtonDown().then(function(){return ou._calculateEventArguments(n.clientPoint)}).then(function(t){n.eventArgs=t;var e=(qa.isWebKit||qa.isIE)&&Qa.isSelectElement(n.element);return e&&n._bindMousedownHandler(),n.eventState.simulateDefaultBehavior=$a[n.downEvent](n.eventArgs.element,n.eventArgs.options),!1===n.eventState.simulateDefaultBehavior&&(n.eventState.simulateDefaultBehavior=e&&!n.eventState.mousedownPrevented),n._focus()})},ou.prototype._focus=function(){var n=this;return new za(function(t){var e=Qa.isContentEditableElement(n.element)?Ja.findContentEditableParent(n.element):n.element;Za.focus(e,t,!1,!0)})},ou.prototype._setSelection=function(){throw new Error("Not implemented")},ou.prototype._mouseup=function(){var e=this;return b.buttonUp().then(function(){return e._setSelection(),ou._calculateEventArguments(e.clientPoint)}).then(function(t){e.eventArgs=t,$a[e.upEvent](e.eventArgs.element,e.eventArgs.options)})},ou.prototype.run=function(){var t=this;return this.absoluteStartPoint=this._calculateAbsoluteStartPoint(),this.absoluteEndPoint=this._calculateAbsoluteEndPoint(),this._moveToPoint(this.absoluteStartPoint).then(function(){return t._mousedown()}).then(function(){return t._moveToPoint(t.absoluteEndPoint)}).then(function(){return t._mouseup()})},ou);function ou(t,e){var n=Ga.call(this,t,e)||this;return n.absoluteStartPoint=null,n.absoluteEndPoint=null,n.clientPoint=null,n.speed=e.speed,n.downEvent=ja.isTouchDevice?"touchstart":"mousedown",n.upEvent=ja.isTouchDevice?"touchend":"mouseup",n.eventArgs={options:null,element:null},n.eventState={mousedownPrevented:!1,simulateDefaultBehavior:!0},n}var ru,su=E.textSelection,lu=E.domUtils,au=E.positionUtils,uu=(e(cu,ru=iu),cu.prototype._calculateAbsoluteStartPoint=function(){return Wa(this.element,this.startPos)||au.findCenter(this.element)},cu.prototype._calculateAbsoluteEndPoint=function(){var t=Wa(this.element,this.endPos);return t||(lu.isContentEditableElement(this.element)?function(t,e,n){for(var i=n<e?1:-1,o=n,r=null;o!==e&&!(r=Ra(t,o+=i)););return r=r||Ra(t,e)||Na.findCenter(t)}(this.element,this.startPos,this.endPos):au.findCenter(this.element))},cu.prototype._setSelection=function(){var t=lu.isTextEditableElement(this.element),e=lu.isContentEditableElement(this.element);(t||e)&&!1!==this.eventState.simulateDefaultBehavior&&su.select(this.element,this.startPos,this.endPos)},cu.prototype.run=function(t){var e=this;return this._ensureElement(t).then(function(){return ru.prototype.run.call(e)})},cu);function cu(t,e,n,i){var o=ru.call(this,t,i)||this;return o.startPos=e,o.endPos=n,o}var hu,fu=E.textSelection,du=E.contentEditable,mu=E.positionUtils,pu=(e(vu,hu=iu),vu.prototype._calculateAbsoluteStartPoint=function(){return Ha(this.element,this.startNode,this.startOffset)||mu.findCenter(this.element)},vu.prototype._calculateAbsoluteEndPoint=function(){return Ha(this.element,this.endNode,this.endOffset)||mu.findCenter(this.element)},vu.prototype._setSelection=function(){if(!1!==this.eventState.simulateDefaultBehavior){var t={node:this.startNode,offset:this.startOffset},e={node:this.endNode,offset:this.endOffset};fu.selectByNodesAndOffsets(t,e,!0)}},vu);function vu(t,e,n){var i=hu.call(this,du.getNearestCommonAncestor(t,e),n)||this,o=du.getFirstVisiblePosition(t),r=du.getLastVisiblePosition(e),s={node:t,offset:o},l={node:e,offset:r},a=du.calculatePositionByNodeAndOffset(i.element,s);return du.calculatePositionByNodeAndOffset(i.element,l)<a&&(o=du.getLastVisiblePosition(t),r=du.getFirstVisiblePosition(e)),s=du.calculateNodeAndOffsetByPosition(t,o),l=du.calculateNodeAndOffsetByPosition(e,r),i.startNode=s.node,i.startOffset=s.offset,i.endNode=l.node,i.endOffset=l.offset,i}var gu=h.Promise,Eu=h.utils.extend,yu=h.utils.browser,Su=h.eventSandbox.eventSimulator,bu=h.eventSandbox.elementEditingWatcher,Pu=E.domUtils,xu=E.promiseUtils,_u=E.contentEditable,Au=E.textSelection,Cu=E.delay,wu=E.KEY_MAPS.specialKeys,Tu=(Mu.findTextEditableChild=function(t){var e=null;if(!Pu.isEditableElement(t))for(var n=t.querySelectorAll("*"),i=0;i<n.length;i++)if(Pu.isTextEditableElementAndEditingAllowed(n[i])){e=n[i];break}return e},Mu.prototype._calculateEventArguments=function(t){var e=Pu.getActiveElement(),n=Pu.isContentEditableElement(this.element),i=this.eventArgs.element||this.element;n||e===i||(i=Mu.findTextEditableChild(e)||e);var o=Eu({keyCode:t?this.currentCharCode:this.currentKeyCode},this.modifiers);return t&&(o.charCode=this.currentCharCode),Eu(o,Ll(t,this.currentKey,this.currentKeyIdentifier)),{element:i,options:o}},Mu.prototype._calculateTargetElement=function(){var t=Pu.getActiveElement(),e=Pu.isContentEditableElement(this.element);if(e){if(t!==_u.findContentEditableParent(this.element))return void(this.eventState.skipType=!0)}else if(t!==this.element)return void(this.eventState.skipType=!0);this.element=e?this.element:t},Mu.prototype._click=function(t){var e=this,n=Pu.getActiveElement(),i=Pu.isTextEditableElementAndEditingAllowed(this.element),o=Pu.isContentEditableElement(this.element);if(n!==this.element){var r=v(this.element),s=r.offsetX,l=r.offsetY,a=new go({offsetX:this.elementChanged?s:this.offsetX,offsetY:this.elementChanged?l:this.offsetY,speed:this.speed,caretPos:this.caretPos,modifiers:this.modifiers});return new Ss(this.element,a).run(t).then(function(){return Cu(e.automationSettings.mouseActionStepDelay)})}if(i&&bu.watchElementEditing(this.element),i||o){var u=Au.getSelectionStart(this.element);isNaN(parseInt(this.caretPos,10))||this.caretPos===u||Au.select(this.element,this.caretPos,this.caretPos)}return gu.resolve()},Mu.prototype._type=function(){var t=this;if(this.eventState.skipType)return gu.resolve();var e=Pu.isContentEditableElement(this.element);return this.replace&&(Pu.isTextEditableElementAndEditingAllowed(this.element)?Au.select(this.element):e&&Au.deleteSelectionContents(this.element,!0)),xu.whilst(function(){return!t._isTypingFinished()},function(){return t._typingStep()})},Mu.prototype._isTypingFinished=function(){return this.currentPos===this.typingText.length},Mu.prototype._typingStep=function(){var t=this.typingText.charAt(this.currentPos);return this.currentKeyCode=Ol(t),this.currentCharCode=this.typingText.charCodeAt(this.currentPos),this.currentKey=this.currentKeyCode===wu.enter?"Enter":t,this.currentKeyIdentifier=Fl(this.currentKey),this._keydown(),this._keypress(),this._keyup()},Mu.prototype._keydown=function(){this.eventArgs=this._calculateEventArguments(),this.eventState.simulateKeypress=Su.keydown(this.eventArgs.element,this.eventArgs.options)},Mu.prototype._keypress=function(){!1!==this.eventState.simulateKeypress&&(this.eventArgs=this._calculateEventArguments(!0),this.eventState.simulateTypeChar=yu.isAndroid||Su.keypress(this.eventArgs.element,this.eventArgs.options))},Mu.prototype._keyup=function(){var t=this,e=this.eventArgs.element;this.eventArgs=this._calculateEventArguments();var n=Pu.isTextEditableElement(this.element),i=Pu.isContentEditableElement(this.element),o=this.paste||!n&&!i;return gu.resolve().then(function(){return o?t._typeAllText(e):t._typeChar(e)}).then(function(){Su.keyup(t.eventArgs.element,t.eventArgs.options),o?t.currentPos=t.typingText.length:t.currentPos++})},Mu.prototype._typeChar=function(t){if(!1===this.eventState.simulateKeypress||!1===this.eventState.simulateTypeChar)return bu.restartWatchingElementEditing(t),Cu(this.automationSettings.keyActionStepDelay);var e=this.typingText.charAt(this.currentPos),n=/^\d$/.test(e),i=0===this.currentPos?null:this.typingText.charAt(this.currentPos-1);if(Pu.isInputElement(t)&&"number"===t.type){var o=Au.getSelectionStart(t),r=Pu.getInputValue(t).length,s=/^\d/.test(this.typingText);if(!n&&(s||!("."===e||"-"===e&&r)||0!==o))return Cu(this.automationSettings.keyActionStepDelay);n&&("."===i||"-"===i&&!r)&&(e=i+e)}return xl(t,e,null),Cu(this.automationSettings.keyActionStepDelay)},Mu.prototype._typeAllText=function(t){return xl(t,this.typingText,this.caretPos),Cu(this.automationSettings.keyActionStepDelay)},Mu.prototype.run=function(t){var e=this;return this._click(t).then(function(){return e._calculateTargetElement()}).then(function(){return e._type()})},Mu);function Mu(t,e,n){this.element=Mu.findTextEditableChild(t)||t,this.typingText=e.toString(),this.modifiers=n.modifiers,this.caretPos=n.caretPos,this.replace=n.replace,this.paste=n.paste,this.offsetX=n.offsetX,this.offsetY=n.offsetY,this.speed=n.speed,this.automationSettings=new k(this.speed),this.elementChanged=t!==this.element,this.currentPos=0,this.currentKeyCode=null,this.currentCharCode=null,this.currentKey=null,this.currentKeyIdentifier=null,this.eventArgs={options:null,element:null},this.eventState={skipType:!1,simulateKeypress:!0,simulateTypeChar:!0}}var Uu=(Du.prototype.run=function(){var e=this;return t.doUpload(this.element,this.paths).then(function(t){if(t.length)throw e.createError(m.arrayUtils.map(t,function(t){return t.path}))})},Du);function Du(t,e,n){this.element=t,this.paths=e,this.createError=n}var Iu=E.domUtils,ku=E.contentEditable,Bu={};Bu.Scroll=f,Bu.Click=Ss,Bu.SelectChildClick=ks,Bu.DblClick=Vs,Bu.DragToOffset=tl,Bu.DragToElement=ol,Bu.Hover=ll,Bu.Press=ba,Bu.RClick=Da,Bu.SelectText=uu,Bu.SelectEditableContent=pu,Bu.Type=Tu,Bu.Upload=Uu,Bu.MouseOptions=mo,Bu.ClickOptions=go,Bu.TypeOptions=Co,Bu.ERROR_TYPES=I,Bu.AutomationSettings=k,Bu.getOffsetOptions=g,Bu.calculateSelectTextArguments=function(t,e){void 0===e&&(e={});var n,i,o,r,s,l,a,u,c,h,f,d=Iu.isTextEditableElement(t),m=d?0:ku.getFirstVisiblePosition(t),p=d?Iu.getElementValue(t).length:ku.getLastVisiblePosition(t),v=e.startPos?Math.min(e.startPos,p):m,g=void 0===e.endPos||null===e.endPos?p:Math.min(e.endPos,p);return void 0!==e.offset?(g=0<=e.offset?Math.min(e.offset,g):(v=g,Math.max(0,g+e.offset)),{startPos:v,endPos:g}):void 0!==e.startLine?(n=t,i=e,o=Iu.getTextAreaValue(n),r=o&&o.length?o.split("\n"):[],s=r.length-1,l=i.startLine?Math.min(i.startLine,s):0,a=r[l]?r[l].length:0,u=i.startPos?Math.min(i.startPos,a):0,c=void 0===i.endLine||null===i.endLine?s:Math.min(i.endLine,s),h=r[c]?r[c].length:0,f=void 0===i.endPos||null===i.endPos?h:Math.min(i.endPos,h),{startPos:Iu.getTextareaPositionByLineAndOffset(n,l,0)+u,endPos:Iu.getTextareaPositionByLineAndOffset(n,c,0)+f}):{startPos:v,endPos:g}},Bu.cursor=b,Bu.getNextFocusableElement=Nl,Bu.getSelectionCoordinatesByPosition=Wa,Bu.getElementFromPoint=U;var Nu=h.nativeMethods,Ou=h.EVENTS.evalIframeScript;Nu.objectDefineProperty(Fu,"%testCafeAutomation%",{configurable:!0,value:Bu}),h.on(Ou,function(t){return Yu(Nu.contentWindowGetter.call(t.iframe))})}(Fu["%hammerhead%"],Fu["%testCafeCore%"],Fu["%testCafeUI%"])}(window);